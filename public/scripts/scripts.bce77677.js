"use strict";angular.module("voluntrApp",["ngAnimate","ngCookies","daterangepicker","ngResource","ngRoute","ngSanitize","ngTouch","facebook","ui.bootstrap","pc035860.scrollWatch","ui.router","ngMaterial","ngFileUpload","pdf","ngMap","Devise","geolocation","highcharts-ng","ng-mfb","mdDateTime","config","angular-duration-format","ui.calendar","snap","leaflet-directive","kendo.directives","ngHandsontable","angulartics","angulartics.google.analytics","ngIdle","ngCsv","md.data.table","ngStorage","angular-flexslider"]).config(["IdleProvider","KeepaliveProvider",function(a,b){a.idle(4),a.timeout(6),b.interval(10)}]).config(["$mdThemingProvider",function(a){a.theme("default").primaryPalette("light-blue",{"default":"A400","hue-1":"100","hue-2":"600","hue-3":"A100"}).accentPalette("pink",{"default":"300"})}]).config(["FacebookProvider","ENV",function(a,b){a.init(b.appId)}]).config(["$httpProvider","AuthProvider",function(a,b){b.registerPath("/api/v1/users.json"),b.loginPath("/api/v1/users/sign_in.json"),a.interceptors.push("authInterceptor")}]).run(["$rootScope","$state","$stateParams",function(a,b,c){a.$state=b,a.$stateParams=c,a.$on("$stateChangeSuccess",function(b,c,d,e,f){a.previousState_name=e.name,a.previousState_params=f}),a.back=function(){b.go(a.previousState_name,a.previousState_params)}}]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("landing_page",{url:"/",templateUrl:"static_pages/landing_page.html",controller:"LandingPageCtrl"}).state("volunteer_drive_16",{url:"/volunteer_drive",templateUrl:"static_pages/volunteer_drive_16/home.html","abstract":!0,controller:"VolunteerDrive16Ctrl"}).state("volunteer_drive_16.menu",{url:"",templateUrl:"static_pages/volunteer_drive_16/menu.html",controller:"VolunteerDrive16Ctrl"}).state("volunteer_drive_16.volunteers",{url:"",templateUrl:"static_pages/volunteer_drive_16/volunteers.html",controller:"VolunteerDrive16Ctrl"}).state("volunteer_drive_16.sponsors",{url:"/sponsors",templateUrl:"static_pages/volunteer_drive_16/sponsors.html",controller:"VolunteerDrive16Ctrl"}).state("volunteer_drive_16.non_profits",{url:"","abstract":!0,templateUrl:"static_pages/volunteer_drive_16/non_profits.html"}).state("volunteer_drive_16.non_profits.1",{url:"",templateUrl:"static_pages/volunteer_drive_16/non_profits_1.html"}).state("volunteer_drive_16.non_profits.2",{url:"",templateUrl:"static_pages/volunteer_drive_16/non_profits_2.html"}).state("volunteer_drive_16.non_profits.3",{url:"",templateUrl:"static_pages/volunteer_drive_16/non_profits_3.html"}).state("volunteer_drive_16.non_profits.4",{url:"",templateUrl:"static_pages/volunteer_drive_16/non_profits_4.html"}).state("volunteer_drive_16.non_profits.form",{url:"/form",templateUrl:"static_pages/volunteer_drive_16/non_profits_form.html"}).state("volunteer_home",{url:"/volunteer_home",templateUrl:"volunteers/volunteer_home.html",controller:"VolunteerHomeCtrl"}).state("volunteers",{url:"/volunteers","abstract":!0,templateUrl:"volunteers/volunteers.html",controller:"VolunteerMainCtrl"}).state("volunteers.export_report",{url:"/export_report",templateUrl:"volunteers/volunteer_export.html",controller:"ExportVolunteerReportCtrl"}).state("organizations",{url:"/organizations","abstract":!0,templateUrl:"organizations/organization.html",controller:"OrganizationMainCtrl"}).state("users",{url:"/users",absolute:!0,templateUrl:"users/users.html",controller:"UsersCtrl"}).state("users.confirm_registration",{url:"/confirm_registration/:token",templateUrl:"users/confirm_registration/confirm_registration.html",controller:"ConfirmUserRegistrationCtrl"}).state("organizations.registration",{url:"/registration",templateUrl:"organizations/registration/organization_registration.html",controller:"OrganizationRegistrationCtrl"}).state("organizations.email_registration",{url:"/email_registration","abstract":!0,templateUrl:"organizations/registration/organization_registration_email.html",controller:"OrganizationRegistrationCtrl"}).state("organizations.email_registration.1",{url:"",templateUrl:"organizations/registration/organization_registration_email_1.html"}).state("organizations.email_registration.2",{url:"",templateUrl:"organizations/registration/organization_registration_email_2.html"}).state("organizations.email_registration.3",{url:"",templateUrl:"organizations/registration/organization_registration_email_3.html"}).state("organizations.user_organizations",{url:"/user_organizations",templateUrl:"organizations/user_organizations/user_organizations.html",controller:"UserOrganizationsCtrl"}).state("organizations.tutorial",{url:"/:organization_Id/tutorial",templateUrl:"organizations/tutorial/tutorial.html",controller:"OrganizationTutorialCtrl"}).state("organizations.tutorial.1",{url:"/1",templateUrl:"organizations/tutorial/tutorial_screen_1.html"}).state("organizations.tutorial.2",{url:"/2",templateUrl:"organizations/tutorial/tutorial_screen_2.html"}).state("organizations.tutorial.3",{url:"/3",templateUrl:"organizations/tutorial/tutorial_screen_3.html"}).state("organizations.tutorial.4",{url:"/4",templateUrl:"organizations/tutorial/tutorial_screen_4.html"}).state("organizations.tutorial.5",{url:"/5",templateUrl:"organizations/tutorial/tutorial_screen_5.html"}).state("organizations.tutorial.6",{url:"/6",templateUrl:"organizations/tutorial/tutorial_screen_6.html"}).state("organizations.organization_home",{url:"/:organization_Id",templateUrl:"organizations/home/organization_home.html",controller:"OrganizationHomeCtrl"}).state("organizations.organization_account",{url:"/:organization_Id/account",templateUrl:"organizations/account/organization_account.html",controller:"OrganizationAccountCtrl"}).state("organizations.people_home",{url:"/:organization_Id/people_home",templateUrl:"organizations/people/people_home.html",controller:"PeopleHomeCtrl"}).state("organizations.bulk_import_people",{url:"/:organization_Id/bulk_import",templateUrl:"organizations/people/bulk_import_people.html",controller:"BulkImportPeopleCtrl"}).state("organizations.nearby_organizations",{url:"/:organization_Id/nearby_organizations",templateUrl:"organizations/nearby_organizations/nearby_organizations.html",controller:"NearbyOrganizationsCtrl"}).state("organizations.opportunities_home",{url:"/:organization_Id/opportunity_home",templateUrl:"organizations/opportunities/opportunities_home.html",controller:"OpportunitiesHomeCtrl"}).state("organization_volunteer_registration",{"abstract":!0,url:"/:organization_custom_Url/registration",templateUrl:"organizations/volunteer_registration/volunteer_registration.html",controller:"OrganizationVolunteerRegistrationCtrl"}).state("organization_volunteer_registration.1",{url:"?token",templateUrl:"organizations/volunteer_registration/volunteer_registration_1.html"}).state("organization_volunteer_registration.2",{url:"/2?token",templateUrl:"organizations/volunteer_registration/volunteer_registration_2.html"}).state("organization_volunteer_registration.3",{url:"/3?token",templateUrl:"organizations/volunteer_registration/volunteer_registration_3.html"}).state("organization_volunteer_registration.4",{url:"/4?token",templateUrl:"organizations/volunteer_registration/volunteer_registration_4.html"}).state("organization_volunteer_registration.5",{url:"/5?token",templateUrl:"organizations/volunteer_registration/volunteer_registration_5.html"}).state("registration_form",{url:"/:opportunity_Id/opportunity_registration",templateUrl:"organizations/opportunities/registration_form.html",controller:"OpportunityRegistrationCtrl"}).state("sign_in_form",{url:"/:opportunity_Id/sign_in/:instance_date","abstract":!0,templateUrl:"organizations/opportunities/sign_in_form.html",controller:"OpportunitySignInCtrl"}).state("sign_in_form.initial_information",{url:"",templateUrl:"organizations/opportunities/sign_in_form_initial_information.html"}).state("sign_in_form.confirmation_information",{url:"",templateUrl:"organizations/opportunities/sign_in_form_confirmation_information.html"}).state("profile",{url:"/profile/:profile_Id",templateUrl:"views/profile.html",controller:"ProfileCtrl"}).state("unauthenticated_forms",{url:"/forms","abstract":!0,templateUrl:"views/unauthenticated_forms.html"}).state("leaderboard",{url:"/leaderboard",templateUrl:"leaderboard/leaderboard.html",controller:"LeaderboardCtrl"}).state("unauthenticated_forms.reset_password",{url:"/request-password-reset",templateUrl:"views/reset_password.html",controller:"ResetPasswordCtrl"}).state("team",{url:"/leaderboard/team",templateUrl:"leaderboard/team.html",controller:"LeaderboardCtrl"}).state("unauthenticated_forms.user_reset_password",{url:"/reset_password/:resetToken",templateUrl:"views/reset_password_2.html",controller:"UserResetPasswordCtrl"})}]);var app=angular.module("voluntrApp");app.factory("XLSXReaderService",["$q","$rootScope",function(a,b){var c=function(a){angular.extend(this,a)};return c.readFile=function(c,d,e){var f=a.defer();return XLSXReader(c,d,e,function(a){b.$apply(function(){f.resolve(a)})}),f.promise},c}]),angular.module("voluntrApp").factory("Organization",["$resource",function(a){function b(){this.service=a("/api/v1/organizations/:organization_Id",{organization_Id:"@id"},{get:{method:"GET",cache:!0},existence_check:{method:"GET",url:"/api/v1/organizations/existence_check/:fb_id"},organization_object:{method:"GET",url:"/api/v1/organizations/:organization_Id/:object",isArray:!0},organization_information:{method:"GET",url:"/api/v1/organizations/:organization_Id/:object"},nearby_organizations:{method:"GET",url:"/api/v1/organizations/:organization_Id/:object?distance=:distance",isArray:!0},get_token:{method:"GET",url:"/api/v1/organizations/:organization_Id/get_token"},organization_filtered_object:{method:"GET",url:"/api/v1/organizations/:organization_Id/:object",isArray:!0},authorization:{method:"GET",url:"/api/v1/organizations/:organization_Id/authorization"},get_by_url:{method:"GET",url:"/api/v1/organizations/by_url/:organization_custom_Url"},create_with_email:{method:"POST",url:"/api/v1/organizations/create/with_email"},update:{method:"PATCH"}}),this.cache={}}return b.prototype.all=function(){return this.service.query()},b.prototype.get=function(a,b,c){return this.service.get(a,b,c)},b.prototype.create=function(a){return this.service.save(a)},b.prototype.create_with_email=function(a){return this.service.create_with_email(a)},b.prototype.update=function(a){return this.service.update(a)},b.prototype["delete"]=function(a){return this.service.remove({organization_Id:a})},b.prototype.existence_check=function(a){return this.service.existence_check({fb_id:a})},b.prototype.recorded_hours=function(a,b){return this.service.organization_object({organization_Id:a,object:b})},b.prototype.associated_organizations=function(a,b){return this.service.organization_object({organization_Id:a,object:b})},b.prototype.daily_statistics=function(a,b){return this.service.organization_object({organization_Id:a,object:b})},b.prototype.summary_statistics=function(a,b){return this.service.organization_information({organization_Id:a,object:b})},b.prototype.opportunities=function(a,b){return this.service.organization_object({organization_Id:a,object:b})},b.prototype.nearby_organizations=function(a,b,c){return this.service.nearby_organizations({organization_Id:a,object:b,distance:c})},b.prototype.contact_volunteers=function(a,b){return this.service.organization_object({organization_Id:a,object:b})},b.prototype.public_opportunities=function(a,b){return this.service.organization_object({organization_Id:a,object:b})},b.prototype.mail_chimp_check=function(a,b){return this.service.organization_object({organization_Id:a,object:b})},b.prototype.people=function(a,b,c){return this.service.organization_filtered_object({organization_Id:a,object:b,query:c})},b.prototype.posts=function(a,b){return this.service.organization_object({organization_Id:a,object:b})},b.prototype.get_by_url=function(a,b,c){return this.service.get_by_url(a,b,c)},b.prototype.authorization=function(a,b){return this.service.authorization({organization_Id:b,fb_id:a})},b.prototype.get_token=function(a){return this.service.get_token({organization_Id:a})},new b}]),angular.module("voluntrApp").factory("Opportunity",["$resource",function(a){function b(){this.service=a("/api/v1/opportunities/:opportunity_Id",{opportunity_Id:"@id"},{update:{method:"PATCH"},update_schedule:{method:"PATCH",url:"/api/v1/opportunities/:opportunity_Id/update_schedule"},opportunity_object:{method:"GET",url:"/api/v1/opportunities/:opportunity_Id/:object",isArray:!0},instances:{method:"GET",url:"/api/v1/opportunities/:opportunity_Id/instances",isArray:!0},delete_instance:{method:"DELETE",url:"/api/v1/opportunities/:opportunity_Id/delete_instance"},delete_future_instances:{method:"DELETE",url:"/api/v1/opportunities/:opportunity_Id/delete_future_instances"}})}return b.prototype.all=function(){return this.service.query()},b.prototype.get=function(a,b,c){return this.service.get(a,b,c)},b.prototype.create=function(a){return this.service.save(a)},b.prototype.instance_statistics=function(a,b){return this.service.opportunity_object({opportunity_Id:a,object:b})},b.prototype.volunteers=function(a,b){return this.service.opportunity_object({opportunity_Id:a,object:b})},b.prototype.recorded_hours=function(a,b){return this.service.opportunity_object({opportunity_Id:a,object:b})},b.prototype.roles=function(a,b){return this.service.opportunity_object({opportunity_Id:a,object:b})},b.prototype.update=function(a){return this.service.update(a)},b.prototype.update_schedule=function(a){return this.service.update_schedule(a)},b.prototype["delete"]=function(a){return this.service.remove({opportunity_Id:a})},b.prototype.delete_instance=function(a,b){return this.service.delete_instance({opportunity_Id:a,date:b})},b.prototype.delete_future_instances=function(a,b){return this.service.delete_future_instances({opportunity_Id:a,date:b})},b.prototype.instances=function(a,b){return this.service.instances({opportunity_Id:a,start_date:b})},new b}]),angular.module("voluntrApp").factory("GroupAdministrator",["$resource",function(a){function b(){this.service=a("/api/v1/group_administrators/:group_administrator_Id",{group_administrator_Id:"@id"},{update:{method:"PATCH"}})}return b.prototype.get=function(a,b,c){return this.service.get(a,b,c)},b.prototype.all=function(){return this.service.query()},b.prototype.create=function(a){return this.service.save(a)},b.prototype.update=function(a){return this.service.update(a)},new b}]),angular.module("voluntrApp").factory("OrganizationPerson",["$resource",function(a){function b(){this.service=a("/api/v1/organization_people/:organization_person_Id",{organization_person_Id:"@id"},{get_by_organization_and_person_id:{method:"GET",url:"/api/v1/organization_people/:organization_Id/:person_Id"},update:{method:"PATCH"}})}return b.prototype.all=function(){return this.service.query()},b.prototype.get_by_organization_and_person_id=function(a,b){return this.service.get_by_organization_and_person_id({organization_Id:a,person_Id:b})},b.prototype.update=function(a){return this.service.update(a)},new b}]),angular.module("voluntrApp").factory("OpportunityRole",["$resource",function(a){function b(){this.service=a("/api/v1/opportunity_roles/:opportunity_role_Id",{opportunity_role_Id:"@id"},{update:{method:"PATCH"},OpportunityRole_object:{method:"GET",url:"/api/v1/opportunities/:opportunity_role_Id/:object",isArray:!0}})}return b.prototype.all=function(){return this.service.query()},b.prototype.get=function(a,b,c){return this.service.get(a,b,c)},b.prototype.create=function(a){return this.service.save(a)},b.prototype.update=function(a){return this.service.update(a)},b.prototype["delete"]=function(a){return this.service.remove({opportunity_role_Id:a})},new b}]),angular.module("voluntrApp").factory("PersonOpportunity",["$resource",function(a){function b(){this.service=a("/api/v1/person_opportunities/:person_opportunity_Id",{organization_Id:"@id"},{update:{method:"PATCH"}})}return b.prototype.create=function(a){return this.service.save(a)},b.prototype.update=function(a){return this.service.update(a)},b.prototype["delete"]=function(a){return this.service.remove({person_opportunity_Id:a})},new b}]),angular.module("voluntrApp").service("authInterceptor",["$rootScope","$q","$location","$injector","$localStorage",function(a,b,c,d,e){return{request:function(a){return a.headers=a.headers||{},e.token?a.headers.Authorization="Bearer "+e.token:sessionStorage.token&&(a.headers.Authorization="Bearer "+sessionStorage.token),a},response:function(a){return a||b.when(a)}}}]),angular.module("voluntrApp").factory("RecordedHours",["$resource",function(a){function b(){this.service=a("/api/v1/recorded_hours/:recorded_hours_Id",{recorded_hours_Id:"@id"},{update:{method:"PATCH"}})}return b.prototype.all=function(){return this.service.query()},b.prototype.get=function(a,b,c){return this.service.get(a,b,c)},b.prototype.create=function(a){return this.service.save(a)},b.prototype.update=function(a){return this.service.update(a)},b.prototype["delete"]=function(a){return this.service.remove({recorded_hours_Id:a})},new b}]),angular.module("voluntrApp").factory("People",["$resource",function(a){function b(){this.service=a("/api/v1/people/:person_Id",{person_Id:"@id"},{update:{method:"PATCH"},add_schedule:{method:"PATCH",url:"/api/v1/people/:person_Id/add_schedule"},person_object:{method:"GET",url:"/api/v1/people/:person_Id/:object",isArray:!0}})}return b.prototype.all=function(){return this.service.query()},b.prototype.get=function(a,b,c){return this.service.get(a,b,c)},b.prototype.create=function(a){return this.service.save(a)},b.prototype.update=function(a){return this.service.update(a)},b.prototype.add_schedule=function(a){return this.service.add_schedule(a)},b.prototype["delete"]=function(a){return this.service.remove({person_Id:a})},b.prototype.recorded_hours=function(a,b){return this.service.person_object({person_Id:a,object:b})},b.prototype.opportunities=function(a,b){return this.service.person_object({person_Id:a,object:b})},new b}]),angular.module("voluntrApp").controller("ProfileCtrl",["$scope","$log","$modal","Profile","$stateParams","$rootScope",function(a,b,c,d,e,f){d.get({profile_Id:e.profile_Id},function(b){a.profile=b},function(a){}),a.open=function(b){var d=c.open({templateUrl:"views/record_hours.html",controller:"RecordHoursCtrl",windowClass:"record-hours-modal-window",size:b});d.result.then(function(){a.profile.total_hours+=f.recordedHours,f.recordedHours=null},function(){console.log("Modal dismissed at: "+new Date)})}}]),angular.module("voluntrApp").controller("RecordHoursCtrl",["$scope","Event","UserEventHours","$modal","$modalInstance","$rootScope",function(a,b,c,d,e,f){a.events=b.all(),a.hours1=0,a.hours2=0,a.h1_up=function(){a.hours1<9&&(a.hours1+=1)},a.h2_up=function(){a.hours2<9&&(a.hours2+=1)},a.h1_down=function(){a.hours1>0&&(a.hours1-=1)},a.h2_down=function(){a.hours2>0&&(a.hours2-=1)},a.recordHours=function(){var b=10*a.hours1+a.hours2,d={};d.event_id=a.recordHours.event_id,d.user_id=localStorage.user_id,d.description=a.description,d.hours=b;var g=c.create(d);f.recordedHours=g.hours,e.close()}}]),angular.module("voluntrApp").factory("UserEventHours",["$resource",function(a){function b(){this.service=a("/api/v1/user_event_hours/:user_event_hours_Id",{organization_Id:"@id"},{update:{method:"PATCH"}})}return b.prototype.all=function(){return this.service.query()},b.prototype.get=function(a,b,c){return this.service.get(a,b,c)},b.prototype.create=function(a){return this.service.save(a)},b.prototype.update=function(a){return this.service.update(a)},b.prototype["delete"]=function(a){return this.service.remove({user_event_hours_Id:a})},new b}]),angular.module("voluntrApp").factory("Profile",["$resource",function(a){function b(){this.service=a("/api/v1/profiles/:profile_Id",{organization_Id:"@id"},{update:{method:"PATCH"}})}return b.prototype.all=function(){return this.service.query()},b.prototype.get=function(a,b,c){return this.service.get(a,b,c)},b.prototype.create=function(a){return this.service.save(a)},b.prototype.update=function(a){return this.service.update(a)},b.prototype["delete"]=function(a){return this.service.remove({profile_Id:a})},new b}]),angular.module("voluntrApp").factory("User",["$resource",function(a){function b(){this.service=a("/api/v1/users/:user_Id",{user_Id:"@id"},{update:{method:"PATCH"}})}return b.prototype.get=function(a,b,c){this.service.get(a,b,c)},b.prototype.update=function(a){return this.service.update(a)},new b}]),angular.module("voluntrApp").factory("searchService",function(){return{search:{query:""}}}),angular.module("voluntrApp").factory("MailingServiceList",["$resource",function(a){function b(){this.service=a("/api/v1/mailing_service_list/:mailing_service_list_Id",{mailing_service_list_Id:"@id"},{update:{method:"PATCH"}})}return b.prototype.get=function(a,b,c){return this.service.get(a,b,c)},b.prototype.all=function(){return this.service.query()},b.prototype.update=function(a){return this.service.update(a)},new b}]),angular.module("voluntrApp").factory("Group",["$resource",function(a){function b(){this.service=a("/api/v1/groups/:group_Id",{group_Id:"@id"},{update:{method:"PATCH"},group_object:{method:"GET",url:"/api/v1/groups/:group_Id/:object",isArray:!0}})}return b.prototype.get=function(a,b,c){return this.service.get(a,b,c)},b.prototype.all=function(){return this.service.query()},b.prototype.create=function(a){return this.service.save(a)},b.prototype.people=function(a,b){return this.service.group_object({group_Id:a,object:b})},b.prototype.recorded_hours=function(a,b){return this.service.group_object({group_Id:a,object:b})},b.prototype.opportunities=function(a,b){return this.service.group_object({group_Id:a,object:b})},b.prototype.update=function(a){return this.service.update(a)},new b}]),angular.module("voluntrApp").factory("OrganizationMailingService",["$resource",function(a){function b(){this.service=a("/api/v1/organization_mailing_services/:organization_mailing_service_Id",{organization_mailing_service_Id:"@id"},{update:{method:"PATCH"}})}return b.prototype.get=function(a,b,c){return this.service.get(a,b,c)},b.prototype.all=function(){return this.service.query()},b.prototype.update=function(a){return this.service.update(a)},b.prototype["delete"]=function(a){return this.service.remove({organization_mailing_service_Id:a})},new b}]),angular.module("voluntrApp").factory("Schedule",["$resource",function(a){function b(){this.service=a("/api/v1/schedules/format/schedule_string")}return b.prototype.schedule_string=function(a,b,c){return this.service.get(a,b,c)},new b}]),angular.module("voluntrApp").factory("Resource",["$resource",function(a){function b(){this.service=a("/api/v1/resources/:resource_Id",{resource_Id:"@id"},{update:{method:"PATCH"}})}return b.prototype.all=function(){return this.service.query()},b.prototype.get=function(a,b,c){return this.service.get(a,b,c)},b.prototype.update=function(a){return this.service.update(a)},b.prototype["delete"]=function(a){return this.service.remove({resource_Id:a})},new b}]),angular.module("voluntrApp").factory("Leaderboard",["$http",function(a){return{get:function(){return a.get("api/v1/administration/volunteer_drive_leaderboard")}}}]),angular.module("voluntrApp").controller("ProfileCreateCtrl",["$scope","Profile","$modalInstance",function(a,b,c){a.createProfile=function(){console.log("modal");var d={};d.user_id=a.user.id,d.first_name=a.createProfile.first_name,d.last_name=a.createProfile.last_name;var e=b.create(d);a.user.profile=e,c.close()}}]),angular.module("voluntrApp").controller("AddDataCtrl",["$scope","organization","Facebook","$filter",function(a,b,c,d){a.organization=b,a.toggleImpressionDataOnLineGraph=function(b,d,e){var f={name:e,data:[]},g=[];angular.forEach(b,function(a){var b=[];if("shared_post"!==d)var c={method:"GET",relative_url:"/"+a.id+"/insights/"+d+"/lifetime"};else if("shared_post"===d)var c={method:"GET",relative_url:"/"+a.id+"/sharedposts/"};b[0]=a.created_time,g.push(c),f.data.push(b)}),c.api("/","POST",{batch:g,include_headers:!1},function(a){for(var b=a.length-1;b>=0;b--){var c=a[b],e=JSON.parse(c.body);"shared_post"!==d?(console.log(f),f.data[b][1]=e.data[0].values[0].value):"shared_post"===d&&(f.data[b][1]=e.data.length)}}),a.lineGraphConfig.series.push(f),console.log(f.data),console.log(a.lineGraphConfig.series)}}]),angular.module("voluntrApp").controller("ResetPasswordCtrl",["$scope","$http",function(a,b){a.formData={},a.requestReset=function(){var c=a.formData;b.post("api/v1/users/reset_password",c).then(function(){a.requestSent=!0})}}]),angular.module("voluntrApp").controller("UserResetPasswordCtrl",["$scope","$http","$stateParams","$localStorage","$state",function(a,b,c,d,e){a.data={},a.resetPassword=function(){var f={password:a.data.password,reset_password_token:c.resetToken};b.post("/api/v1/users/update_password_reset",f).then(function(a){a.data.token?(delete d.token,d.token=a.data.token,e.go("organizations.user_organizations")):a.data.token||alert("Something Went Wrong...  We're sorry and will fix it :( ")})["catch"](function(){})}}]),angular.module("voluntrApp").controller("LandingPageCtrl",["$scope","Facebook","Organization","$http","$state","Auth","$rootScope","$location","$window","$modal",function(a,b,c,d,e,f,g,h,i,j){$(".fadein img:gt(0)").hide(),setInterval(function(){$(".fadein :first-child").fadeOut().next("img").fadeIn().end().appendTo(".fadein")},4e3),$(".screen1button").click(function(){$("#login").fadeIn(400),$(".nav").addClass("hide"),$(".sticky").addClass("hide")}),$(".close").click(function(){$("#login").fadeOut(400),$(".nav").removeClass("hide"),$(".sticky").removeClass("hide")}),$(".navicon").click(function(){$(".navmenu").toggleClass("navb")}),a.newContact=function(){d.post("/api/v1/user/contact_form",{email:a.newContact.contact_email,content:a.newContact.contact_content}).success(function(b,c,d,e){alert("Thanks for Contacting Us, We Will Respond Soon!"),a.newContact.contact_email="",a.newContact.contact_content=""}).error(function(b,c,d,e){alert("Thanks for Contacting Us, We Will Respond Soon!"),a.newContact.contact_email="",a.newContact.contact_content=""})},a.open_lp_modal=function(b){var c=j.open({templateUrl:"views/tos_privacy.html",controller:"LandingPageCtrl",windowClass:"tos-modal-window",size:b});c.result.then(function(){a.profile.total_hours+=g.recordedHours,g.recordedHours=null},function(){console.log("Modal dismissed at: "+new Date)})}}]),angular.module("voluntrApp").controller("VolunteerDrive16Ctrl",["$scope","$timeout","$state","$rootScope",function(a,b,c,d){"volunteer_drive_16.menu"!==c.current.name?a.menu=!0:"volunteer_drive_16.menu"===c.current.name&&(a.menu=!1),a.name=!0,d.$on("$stateChangeStart",function(b,c,d,e,f){"volunteer_drive_16.menu"!==c.name&&(a.menu=!0),"volunteer_drive_16.non_profits.form"===c.name&&(a.no_buttons=!0),"volunteer_drive_16.non_profits.form"!==c.name&&(a.no_buttons=!1)}),a.prod={imagePaths:[]},a.prod.imagePaths=[{custom:"images/young_leaders_united.jpg",thumbnail:"images/young_leaders_united.jpg"},{custom:"images/centerstate.png",thumbnail:"images/centerstate.png"},{custom:"images/believe_in_cuse.jpg",thumbnail:"images/believe_in_cuse.jpg"},{custom:"images/forty_below.png",thumbnail:"images/forty_below.png"},{custom:"images/onondaga_community_college.jpg",thumbnail:"images/onondaga_community_college.jpg"},{custom:"images/esf.png",thumbnail:"images/esf.png"},{custom:"images/rha.jpg",thumbnail:"images/rha.jpg"},{custom:"images/the_tech_garden.png",thumbnail:"images/the_tech_garden.png"}],a.introduction=!0,b(function(){a.introduction=!1,a.loaded=!0},3e3),a.formScreen=function(){c.go("volunteer_drive_16.non_profits.form"),a.no_buttons=!0},a.button_text="How Does It Work?",a.changeState=function(b){c.is("volunteer_drive_16.non_profits.1")&&(c.go("volunteer_drive_16.non_profits.2"),a.button_text="What Do I Get Out Of It?"),c.is("volunteer_drive_16.non_profits.2")&&(a.button_text="Alright, I'm Sold Where Do I Sign Up?",c.go("volunteer_drive_16.non_profits.3")),c.is("volunteer_drive_16.non_profits.3")&&c.go("volunteer_drive_16.non_profits.form")}}]),angular.module("voluntrApp").controller("VolunteerMainCtrl",["$scope",function(a){}]),angular.module("voluntrApp").controller("ExportVolunteerReportCtrl",["$scope","$http",function(a,b){a.date={},a.sendReport=function(){b.get("api/v1/reports/public/person",{params:{start_date:a.date.startDate,end_date:a.date.endDate,email:a.email_address}}).then(function(b){a.report_sent=!0},function(b){a.error=!0,a.error_message=b.data.error})}}]),angular.module("voluntrApp").controller("OrganizationRegistrationCtrl",["$scope","Facebook","$http","Organization","$state","$stateParams","$modal","$localStorage","Auth","Profile",function(a,b,c,d,e,f,g,h,i,j){a.register={},a.organization={},a.facebook_log_in=function(){b.login(function(b){a.oauth_key=b.authResponse.accessToken},{scope:"manage_pages,email"})},a.$watch("oauth_key",function(){a.oauth_key&&b.api("/me",function(b){a.user=b,console.log(a.user);var d={};d.fb_id=a.user.id,d.token=a.oauth_key,d.first_name=a.user.first_name,d.last_name=a.user.last_name,d.email=a.user.email,console.log(d),c({url:"/api/v1/users/login/facebook_login",method:"GET",params:d}),e.go("organizations.user_organizations")})}),a.progress=33,a.registration_prompt="Step 1:  Initial Information",a.createUser=function(){a.loading=!0;var b={};b.email=a.register.user_email,b.organization={},b.organization.organization_type_name=a.register.organization_type_name,b.organization.organization_name=a.register.organization_name,i.register(b).then(function(b){b.token?(a.loading=!1,h.token=b.token,e.go("organizations.email_registration.2"),a.registration_prompt="Step 2:  Additional Information",a.progress=66,a.organization_id=b.organization_id):b.token||(a.loading=!1,a.error=b.error)})},a.log_in_modal=function(a){var b=g.open({templateUrl:"organizations/modals/log_in.html",controller:"EmailLogInCtrl",windowClass:"email-registration-modal",size:a});b.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})},a.updateNewUserWithPassword=function(){a.loading=!0;var b={};b.user={},b.user.password=a.register.password,b.user.password_confirmation=a.register.confirm_password;var f={};f.first_name=a.register.first_name,f.last_name=a.register.last_name,j.create(f),c({method:"PATCH",url:"/api/v1/users/update_password",data:b}).then(function(b){d.get_token(a.organization_id).$promise.then(function(b){a.loading=!1,h.token=b.token,a.progress=99,a.registration_prompt="Step 3:  Add Organization Address",e.go("organizations.email_registration.3")})})},a.updateNewUserWithAddress=function(){a.loading=!0;var b={};b.id=a.organization_id,b.address_1=a.organization.address,b.address_2=a.organization.address2,b.city=a.organization.city,b.state=a.organization.state,b.zip_code=a.organization.postalCode,d.update(b).$promise.then(function(){a.loading=!1,e.go("organizations.tutorial.1",{organization_Id:a.organization_id})})},a.states="AL AK AZ AR CA CO CT DE FL GA HI ID IL IN IA KS KY LA ME MD MA MI MN MS MO MT NE NV NH NJ NM NY NC ND OH OK OR PA RI SC SD TN TX UT VT VA WA WV WI WY".split(" ").map(function(a){return{abbrev:a}})}]),angular.module("voluntrApp").controller("UserOrganizationsCtrl",["$scope","Facebook","$http","Organization","$state","$stateParams","$modal","$localStorage","$mdDialog",function(a,b,c,d,e,f,g,h,i){a.$watch(function(){return h.token},function(){h.token&&void 0!==h.token?(a.logged_in=!0,a.organizations=[],console.log(!0),c({url:"api/v1/users/current/organizations"}).then(function(b){angular.forEach(b.data,function(b){console.log(b),b.fb_id||a.organizations.push(b)})},function(a){})):h.token||(a.logged_in=!1)}),a.logInWithEmaiLregistration=function(a){d.get_token(a.id).$promise.then(function(b){delete h.token,h.token=b.token,e.go("organizations.organization_home",{organization_Id:a.id})})},a.createNewOrganization=function(a){i.show({controller:"CreateOrganizationModal",
templateUrl:"organizations/modals/create_organization.html",parent:angular.element(document.body),clickOutsideToClose:!0}).then(function(a){},function(){})},b.getLoginStatus(function(b){"connected"===b.status?(a.connected_to_facebook=!0,a.oauth_key=b.authResponse.accessToken):"connected"!==b.status&&(a.connected_to_facebook=!1)});var j=function(c){if(!a.organizations){var e=[];a.organizations=e}d.existence_check(c.id).$promise.then(function(d){d.id?(c.exists=!0,c.v_id=d.id,c.fb_id=d.fb_id,null===d.picture.picture.url?b.api("/"+c.id+"/picture",{type:"large"},function(a){c.fb_picture=a.data.url}):null!==d.picture.picture.url&&(c.picture=d.picture),d.nonprofit?c.nonprofit=!0:d.volunteer_group&&(c.volunteer_group=!0)):d.id||(c.exists=!1),a.organizations.push(c)})};a.authorizeUser=function(b){d.authorization(a.user.id,b.v_id).$promise.then(function(a){delete h.token,h.token=a.token,e.go("organizations.organization_home",{organization_Id:a.organization.id})})},a.$watch("connected_to_facebook",function(){a.connected_to_facebook&&(b.api("/me/accounts",function(a){angular.forEach(a.data,j)}),b.api("/me",function(b){a.user=b}))}),a.addFacebookOrganization=function(b){var c=g.open({templateUrl:"organizations/modals/add_facebook_organization.html",controller:"AddFacebookOrganization",windowClass:"add-facebook-organization-window",size:"sm",resolve:{organization:function(){return b},user:function(){return a.user},token:function(){return a.oauth_key}}});c.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})}}]),angular.module("voluntrApp").controller("OrganizationMainCtrl",["$scope","Facebook","$stateParams","$http","$state","$filter","uiCalendarConfig","$rootScope",function(a,b,c,d,e,f,g,h){a.$on("$stateChangeSuccess",function(){a.current_state=e.current.name,h.organization_id=e.params.organization_Id})}]),angular.module("voluntrApp").controller("OrganizationHomeCtrl",["$scope","Facebook","Organization","$stateParams","$state","Opportunity","$http","$filter","$parse","$modal","$rootScope",function(a,b,c,d,e,f,g,h,i,j,k){var l=function(b){a.lineGraphConfig.series[0].data.push([Date.parse(b.post_time),Number(b.likes)])},m=function(b){a.lineGraphConfig.series[1].data.push([Date.parse(b.date),Number(b.total_recorded_hours)]),a.lineGraphConfig.series[2].data.push([Date.parse(b.date),Number(b.total_added_volunteers)])};a.loaded=!1,c.get({organization_Id:d.organization_Id}).$promise.then(function(b){a.organization=b,k.organization_name=b.name}),a.$watch("organization",function(){a.organization&&a.organization.id&&(c.recorded_hours(a.organization.id,"recently_recorded_hours").$promise.then(function(b){a.organization.recorded_hours=b}),c.daily_statistics(a.organization.id,"daily_statistics").$promise.then(function(b){a.organization.daily_statistics=h("orderBy")(b,"date"),angular.forEach(a.organization.daily_statistics,m)}),c.summary_statistics(a.organization.id,"summary_statistics").$promise.then(function(b){a.organization.statistics=b,a.organization.statistics.average_hours_recorded||(a.organization.statistics.average_hours_recorded=0)}),c.contact_volunteers(a.organization.id,"contact_volunteers").$promise.then(function(b){a.organization.contact_volunteers=b}),c.posts(a.organization.id,"posts").$promise.then(function(b){a.organization.posts=a.organization.posts=h("orderBy")(b,"post_time"),angular.forEach(a.organization.posts,l)}),a.loaded=!0)}),k.lineGraphConfig={options:{chart:{type:"spline",zoomType:"xy"}},xAxis:{type:"datetime",title:{text:"Date"}},yAxis:{allowDecimals:!1,floor:0},series:[{name:"Post Likes",data:[]},{name:"Total Recorded Volunteer Hours",data:[]},{name:"Total Added Volunteers",data:[]}],title:{text:"Your Organization's Timeline"},loading:!1,size:{height:"250"}}}]),angular.module("voluntrApp").controller("BulkImportPeopleCtrl",["$scope","$modal","$http","$stateParams","$state",function(a,b,c,d,e){function f(){a.data.workbook&&(a.errors.file=!1,a.data.matchConfirmed=!1,a.data.possibleCustomFields=[],a.data.notImportedFields=[],a.data.rowTitles=[],a.data.checkResponse=null,a.data.activeWorksheet=a.data.workbook.SheetNames[0],a.data.worksheetNames=a.data.workbook.SheetNames,g())}function g(){a.data.rowTitles=h(a.data.workbook.Sheets[a.data.activeWorksheet]),null!==a.data.rowTitles&&c({method:"GET",url:"api/v1/spreadsheet_import/check",params:{"row_titles[]":a.data.rowTitles}}).then(function(b){a.data.checkResponse=b.data.database_map,a.mapped=!0,a.isUnique()})}function h(a){var b=[];if(0===Object.keys(a).length)return null;var c,d=XLSX.utils.decode_range(a["!ref"]),e=d.s.r;for(c=d.s.c;c<=d.e.c;++c){var f,g=a[XLSX.utils.encode_cell({c:c,r:e})];g&&g.t&&(f=XLSX.utils.format_cell(g),b.push(f))}return b}function i(a){var b={};for(var c in a)b[a[c]]=c;return b}function j(){a.errors.file=!0}a.database_attributes=["first_name","last_name","address_1","address_2","email","zip_code","state","city","occupation","phone","organization_name","notes"],a.data={},a.joined_columns={},a.errors={},a.errors.file=!1,a.data.possibleCustomFields=[],a.data.notImportedFields=[];var k;a.removePossibleCustomField=function(b){var c=a.data.possibleCustomFields.splice(b,1);a.data.notImportedFields.push(c[0])},a.addPossibleCustomField=function(b){var c=a.data.notImportedFields.splice(b,1);a.data.possibleCustomFields.push(c[0])},a.$on("fileChange",f),a.$on("fileError",j),a.setWorksheet=function(){g()},a.confirmDatabaseMatch=function(){k=a.data.workbook.Sheets[a.data.activeWorksheet];var b,c=XLSX.utils.decode_range(k["!ref"]),d=c.s.r,e=i(a.data.checkResponse);for(b=c.s.c;b<=c.e.c;b++){var f="345u2@#22891ndmvdv.124/sjsshv$#",g=XLSX.utils.encode_cell({c:b,r:d});if(k[g])if(f=k[g].w,f in e)k[g].w=e[f];else{a.data.possibleCustomFields.push(k[g].w);var h="customField "+k[g].w;k[g].w=h}}a.data.matchConfirmed=!0},a.importWorksheet=function(){for(var c=XLSX.utils.sheet_to_json(k),e=0;e<c.length;e++){if(c[e][null]&&delete c[e][null],a.data.possibleCustomFields.length>0){c[e].custom_fields={};for(var f=0;f<a.data.possibleCustomFields.length;f++){var g=a.data.possibleCustomFields[f],h=c[e]["customField "+g];delete c[e]["customField "+g],c[e].custom_fields[g]=h}}if(a.data.notImportedFields.length>0)for(var i=0;i<a.data.notImportedFields.length;i++){var j=a.data.notImportedFields[i];delete c[e]["customField "+j]}}var l={people:c,organization_id:d.organization_Id,name_column:a.joined_columns.name_column,address_column:a.joined_columns.address_column},m=b.open({templateUrl:"organizations/modals/import_people.html",controller:"ImportPeopleModalCtrl",windowClass:"import-people-modal",size:"lg",resolve:{import_information:function(){return l}}});m.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})},a.isUnique=function(){a.data.isUnique=!0;var b={},c=a.data.checkResponse;for(var d in c)void 0===b[c[d]]&&c[d]!==!1&&""!==c[d]&&null!==c[d]?b[c[d]]=!0:c[d]!==!1&&""!==c[d]&&null!==c[d]&&(b[c[d]]=!1,a.data.isUnique=!1);a.errors.unique=b}}]),angular.module("voluntrApp").controller("OrganizationAccountCtrl",["$scope","Organization","$stateParams","$state","$rootScope","$http","$window","ENV","OrganizationMailingService","Facebook","Upload","$timeout","$mdDialog",function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.get({organization_Id:c.organization_Id},function(b){a.organization=b,null===a.organization.picture.picture.url&&j.api("/"+b.fb_id+"/picture",{type:"large"},function(b){a.organization.fb_picture=b.data.url})}),a.authorize_mailchimp=function(){g.location.href="https://login.mailchimp.com/oauth2/authorize?client_id="+h.mailchimp_id+"&response_type=code&state="+btoa(c.organization_Id)},f({url:"api/v1/organizations/"+c.organization_Id+"/auth/mail_chimp_check",method:"get"}).success(function(b){b.mail_chimp?(a.mailchimp_authorized=!0,a.mailchimp=b.mail_chimp):b.error&&(a.mailchimp_authorized=!1)}).error(function(a){}),a["delete"]=function(b){i["delete"](b.id);var c=a.organization.organization_mailing_services.indexOf(b);c>-1&&a.organization.organization_mailing_services.splice(c,1),a.mailchimp_authorized=!1};var n=["DANGER ZONE","HERE BE DRAGONS"];a.warning_message=n[Math.floor(Math.random()*n.length)],a.showConfirm=function(c){var e=m.confirm().title("Would you like to delete your Organization?").textContent("Everything will be deleted.").targetEvent(c).ok("I Want Out!").cancel("I'll Give You More Time");m.show(e).then(function(){b["delete"](a.organization.id).$promise.then(function(){}),a.status="You decided to get rid of your debt.",d.go("landing_page")},function(){a.status="We're glad you decided to stay"})},a.uploadFiles=function(b){a.f=b,b&&!b.$error&&(b.upload=k.upload({url:"api/v1/organizations/"+a.organization.id,method:"PATCH",file:{"organization[terms_of_service_file]":b}}),b.upload.then(function(a){l(function(){b.result=a.data})},function(b){b.status>0&&(a.errorMsg=b.status+": "+b.data)}),b.upload.progress(function(a){b.progress=Math.min(100,parseInt(100*a.loaded/a.total))}))},a.$watch("file",function(){a.file&&k.upload({url:"/api/v1/organizations/"+a.organization.id,method:"PATCH",file:{"organization[picture]":a.file}}).then(function(b){a.organization.picture=b.data.picture})})}]),angular.module("voluntrApp").controller("OrganizationVolunteerRegistrationCtrl",["$scope","$stateParams","$http","$state","$filter","$rootScope","Facebook","Organization","People","$timeout","OrganizationPerson",function(a,b,c,d,e,f,g,h,i,j,k){h.get_by_url({organization_custom_Url:b.organization_custom_Url},function(b){console.log("get"),a.organization=b,null===a.organization.picture.picture.url?g.api("/"+b.fb_id+"/picture",{type:"large"},function(b){a.organization.picture=b.data.url}):null!==a.organization.picture.picture.url&&(a.organization.picture=b.picture.picture.url),a.submittable=!1,d.params.token&&i.get({person_Id:atob(d.params.token)},function(b){a.person=b,a.schedule=b.schedule_update_form_settings,k.get_by_organization_and_person_id(a.organization.id,a.person.id).$promise.then(function(b){a.organization_person=b,a.person.notes=b.notes})})}),a.createPerson=function(b){var c={};c.email=b.email,c.first_name=b.first_name,c.last_name=b.last_name,c.phone=b.phone,c.organization_id=a.organization.id,d.params.token?d.params.token&&i.update(c).$promise.then(function(b){a.person=b,d.go("organization_volunteer_registration.2",{token:btoa(a.person.id)})}):i.create(c).$promise.then(function(b){a.person=b,d.go("organization_volunteer_registration.2",{token:btoa(a.person.id)})})},a.schedule||(a.schedule={}),a.updateWithAddress=function(b){var c={};c.id=a.person.id,c.address_1=b.address_1,c.address_2=b.address_2,c.state=b.state,c.city=b.city,c.zip_code=b.zip_code,i.update(c).$promise.then(function(b){a.person=b,d.go("organization_volunteer_registration.3",{token:btoa(a.person.id)})})},a.updateWithSchedule=function(){var b={};b.id=a.person.id,b.schedule=a.schedule,i.update(b).$promise.then(function(b){d.go("organization_volunteer_registration.4",{token:btoa(a.person.id)})})},a.updateWithAdditionalInformation=function(b){var c={};if(c.id=a.person.id,c.phone=b.phone,c.organization_name=b.organization_name,c.occupation=b.occupation,console.log(a.organization_person),console.log(a.person),b.notes){var e={};e.id=a.organization_person.id,e.notes=b.notes,k.update(e)}i.update(c).$promise.then(function(a){d.go("volunteer_home")})},a.occupations=["Management","Sales","Accounting","Marketing","Information Technology","Media","Engineering"],a.referrers=["Through a Friend","Through Social Media","Through Another Organization I'm Involved In","Through A Religious Group","Through Work","Walked In One Day"],a.demographic={},a.demographic.birthday=new Date,a.demographicData=function(b){var c={};c.date_of_birth=a.demographic.date_of_birth,c.gender=a.demographic.gender,c.occupation=a.demographic.occupation,c.referred_from=a.demographic.referred_from}}]),angular.module("voluntrApp").controller("OrganizationTutorialCtrl",["$scope","$modal","$rootScope","$http","$stateParams","searchService","$window","$state",function(a,b,c,d,e,f,g,h){a.$on("$stateChangeSuccess",function(){a.current_state=h.current.name}),a.$watch("current_state",function(){"organizations.tutorial.1"===a.current_state?(a.back_link_text="",a.link_text="Importing People To Your Organization",a.link_state="organizations.tutorial.2"):"organizations.tutorial.2"===a.current_state?(a.back_link_text="Back to Introduction",a.back_link_state="organizations.tutorial.1",a.link_text="Read About Adding Opportunities and Volunteers",a.link_state="organizations.tutorial.3"):"organizations.tutorial.3"===a.current_state?(a.back_link_text="Back to Importing Your Data on Volu",a.back_link_state="organizations.tutorial.2",a.link_text="Read About Registering Your Volunteers",a.link_state="organizations.tutorial.4"):"organizations.tutorial.4"===a.current_state?(a.back_link_text="Back to Quickly Adding Objects on Volu",a.back_link_state="organizations.tutorial.3",a.link_text="Read About Finding Things on Volu",a.link_state="organizations.tutorial.5"):"organizations.tutorial.5"===a.current_state?(a.back_link_text="Back to Registering Volunteers on Volu",a.back_link_state="organizations.tutorial.4",a.link_text="Read About How Volu Integrates With Your Current Services",a.link_state="organizations.tutorial.6"):"organizations.tutorial.6"===a.current_state&&(a.back_link_text="Back to Integrating Services With Volu",a.back_link_state="organizations.tutorial.5",a.link_text="Access Your Dashboard")}),a.backFunction=function(){h.go(a.back_link_state)},a.forwardFunction=function(){return"organizations.tutorial.6"===a.current_state?void h.go("organizations.organization_home",{organization_Id:e.organization_Id}):void h.go(a.link_state)}}]),angular.module("voluntrApp").controller("NearbyOrganizationsCtrl",["$scope","$modal","Group","Organization","$stateParams",function(a,b,c,d,e){function f(){var a=Math.random();return.8>a?1:.9>a?2:3}function g(){return h[Math.floor(Math.random()*h.length)]}a.nearby_loaded=!1,a.loaded=!0,a.associated_organizations=[],a.nearby_organizations=[],a.distance=10,a.distances=[5,10,25,50,75,100,250];var h=["#ffebee","#ffcdd2","#ef9a9a","#e57373","#ef5350","#f44336","#e53935","#d32f2f","#c62828","#b71c1c","#ff8a80","#ff5252","#ff1744","#d50000","#f8bbd0","#f48fb1","#f06292","#ec407a","#e91e63","#d81b60","#c2185b","#ad1457","#880e4f","#ff80ab","#ff4081","#f50057","#c51162","#e1bee7","#ce93d8","#ba68c8","#ab47bc","#9c27b0","#8e24aa","#7b1fa2","#4a148c","#ea80fc","#e040fb","#d500f9","#aa00ff","#ede7f6","#d1c4e9","#b39ddb","#9575cd","#7e57c2","#673ab7","#5e35b1","#4527a0","#311b92","#b388ff","#7c4dff","#651fff","#6200ea","#c5cae9","#9fa8da","#7986cb","#5c6bc0","#3f51b5","#3949ab","#303f9f","#283593","#1a237e","#8c9eff","#536dfe","#3d5afe","#304ffe","#e3f2fd","#bbdefb","#90caf9","#64b5f6","#42a5f5","#2196f3","#1e88e5","#1976d2","#1565c0","#0d47a1","#82b1ff","#448aff","#2979ff","#2962ff","#b3e5fc","#81d4fa","#4fc3f7","#29b6f6","#03a9f4","#039be5","#0288d1","#0277bd","#01579b","#80d8ff","#40c4ff","#00b0ff","#0091ea","#e0f7fa","#b2ebf2","#80deea","#4dd0e1","#26c6da","#00bcd4","#00acc1","#0097a7","#00838f","#006064","#84ffff","#18ffff","#00e5ff","#00b8d4","#e0f2f1","#b2dfdb","#80cbc4","#4db6ac","#26a69a","#009688","#00897b","#00796b","#00695c","#a7ffeb","#64ffda","#1de9b6","#00bfa5","#e8f5e9","#c8e6c9","#a5d6a7","#81c784","#66bb6a","#4caf50","#43a047","#388e3c","#2e7d32","#1b5e20","#b9f6ca","#69f0ae","#00e676","#00c853","#f1f8e9","#dcedc8","#c5e1a5","#aed581","#9ccc65","#8bc34a","#7cb342","#689f38","#558b2f","#33691e","#ccff90","#b2ff59","#76ff03","#64dd17","#f9fbe7","#f0f4c3","#e6ee9c","#dce775","#d4e157","#cddc39","#c0ca33","#afb42b","#9e9d24","#827717","#f4ff81","#eeff41","#c6ff00","#aeea00","#fffde7","#fff9c4","#fff59d","#fff176","#ffee58","#ffeb3b","#fdd835","#fbc02d","#f9a825","#f57f17","#ffff8d","#ffff00","#ffea00","#ffd600","#fff8e1","#ffecb3","#ffe082","#ffd54f","#ffca28","#ffc107","#ffb300","#ffa000","#ff8f00","#ff6f00","#ffe57f","#ffd740","#ffc400","#ffab00","#fff3e0","#ffe0b2","#ffcc80","#ffb74d","#ffa726","#ff9800","#fb8c00","#f57c00","#ef6c00","#e65100","#ffd180","#ffab40","#ff9100","#ff6d00","#fbe9e7","#ffccbc","#ffab91","#ff8a65","#ff7043","#ff5722","#f4511e","#e64a19","#d84315","#bf360c","#ff9e80","#ff6e40","#ff3d00","#dd2c00","#d7ccc8","#bcaaa4","#795548","#d7ccc8","#bcaaa4","#8d6e63","#eceff1","#cfd8dc","#b0bec5","#90a4ae","#78909c","#607d8b","#546e7a","#cfd8dc","#b0bec5","#78909c"];a.$watch("distance",function(){a.nearby_loaded=!1,d.nearby_organizations(e.organization_Id,"nearby_organizations",a.distance).$promise.then(function(b){a.nearby_organizations=[],a.nearby_loaded=!0,console.log(b),angular.forEach(b,function(b){b.rowspan=f(),b.colspan=f(),b.bg_color=g(),a.nearby_organizations.push(b)}),0===b.length&&(a.add_an_address=!0)})}),d.associated_organizations(e.organization_Id,"associated_organizations").$promise.then(function(b){angular.forEach(b,function(b){b.rowspan=f(),b.colspan=f(),b.bg_color=g(),a.associated_organizations.push(b)})})}]),angular.module("voluntrApp").controller("PeopleHomeCtrl",["$scope","Facebook","$http","$stateParams","$modal","Organization","$filter",function(a,b,c,d,e,f,g){function h(b){a.people=b,angular.forEach(b,function(b){a.total_people_count=b.count}),a.loaded=!0}function i(){a.deferred=a.onChange()}a.loaded=!1,a.selected=[],a.filter={options:{debounce:500}},a.query={filter:"",limit:"5",order:"first_name",page:1,contact_only:!1},a.query.contact_only=!0,a.onChange=function(){return f.people(d.organization_Id,"people",a.query).$promise.then(function(b,c,d,e){a.loaded=!0,h(b)})},a.onPaginationChange=function(){return f.people(d.organization_Id,"people",a.query).$promise.then(function(b,c,d,e){a.loaded=!0,h(b)})},a.removeFilter=function(){a.filter.show=!1,a.query.filter="",a.filter.form.$dirty&&a.filter.form.$setPristine()},a.$watchGroup(["query.filter","query.order","query.limit"],function(b,c){if(!c)var d=a.query.page;b!==c&&(a.query.page=1),b||(a.query.page=d),i()}),a.filterByContactInformation=function(){i()},a.bulkAddPeople=function(a){var b=e.open({templateUrl:"organizations/modals/bulk_add_people_modal.html",controller:"BulkAddPeopleCtrl",windowClass:"import-people-modal",size:a});b.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})}}]),angular.module("voluntrApp").controller("OpportunitiesHomeCtrl",["$scope","Facebook","$stateParams","$http","$state","$filter","uiCalendarConfig","$modal","Opportunity","$mdDialog",function(a,b,c,d,e,f,g,h,i,j){a.eventSources=[{url:"api/v1/organizations/"+c.organization_Id+"/opportunities"},[]],a.uiConfig={myCalendar:{height:500,editable:!0,timezone:"local",eventTextColor:"white",header:{left:"month agendaWeek agendaDay",center:"title",right:"today prev,next"},businessHours:{start:"7:00",end:"20:00",dow:[1,2,3,4,5]}}},a.opportunityDetail=function(b,c){j.show({controller:"OpportunityDetailCtrl",templateUrl:"organizations/modals/opportunity_detail.html",parent:angular.element(document.body),clickOutsideToClose:!0,locals:{id:b,start_time:c,opportunity:d.get("api/v1/opportunities/"+b,{params:{instance_date:new Date(c).getTime()}})}}).then(function(b){a.status='You said the information was "'+b+'".'},function(){a.status="You cancelled the dialog."})},a.uiConfig.myCalendar.eventClick=function(b,c,d){a.opportunityDetail(b.id,b._start._i)}}]),angular.module("voluntrApp").controller("OpportunityRegistrationCtrl",["$scope","People","$stateParams","Opportunity","PersonOpportunity","$modal","Organization","Facebook","$http","$state",function(a,b,c,d,e,f,g,h,i,j){var k=function(b){null==a.opportunity.volunteer_goal&&(a.opportunity.volunteer_goal=5),b.instance_volunteers.length<a.opportunity.volunteer_goal&&a.dates.push(b.instance_date)};d.get({opportunity_Id:c.opportunity_Id},function(b){a.opportunity=b;var c=new Date;i({method:"GET",url:"api/v1/opportunity/"+a.opportunity.id+"/schedule",params:{start:new Date,end:new Date(new Date(c).setMonth(c.getMonth()+6))}}).then(function(b){a.dates=[],angular.forEach(b.data,k)}),g.get({organization_Id:b.organization_id},function(b){a.custom_url=b.custom_url,null===b.picture.picture.url?h.api("/"+b.fb_id+"/picture",{type:"large"},function(b){a.organization_picture=b.data.url}):null!==b.picture.picture.url&&(a.organization_picture=b.picture.picture.url)})}),a.registerForOpportunity=function(){var b={};b.opportunity_id=c.opportunity_Id,b.first_name=a.opportunityRegister.first_name,b.last_name=a.opportunityRegister.last_name,b.email=a.opportunityRegister.email,a.opportunityRegister.dates&&(b.instances=a.opportunityRegister.dates),b.organization_id=a.opportunity.organization_id,e.create(b).$promise.then(function(b){j.go("organization_volunteer_registration.2",{token:btoa(b.id),organization_custom_Url:a.custom_url})})}}]),angular.module("voluntrApp").controller("OpportunitySignInCtrl",["$scope","People","$stateParams","Opportunity","PersonOpportunity","$modal","$filter","Facebook","$state","RecordedHours","$timeout",function(a,b,c,d,e,f,g,h,i,j,k){a.photo_consent=!0,a.contact_me=!0,a.recordedHour={},a.confirmed=!1,d.get({opportunity_Id:c.opportunity_Id},function(b){a.opportunity=b,console.log(b),null===b.organization.picture.url?h.api("/"+b.organization.fb_id+"/picture",{type:"large"},function(b){a.organization_picture=b.data.url}):null!==b.organization.picture.url&&(console.log(b.organization),a.organization_picture=b.organization.picture.url)}),a.terms_of_service=!0,a.$watchGroup(["opportunitySignIn.first_name","opportunitySignIn.last_name","opportunitySignIn.email","opportunitySignIn.phone","opportunitySignIn.no_email_or_phone"],function(){a.opportunitySignIn.first_name&&a.opportunitySignIn.last_name||a.opportunitySignIn.email&&a.opportunitySignIn.phone&&a.opportunitySignIn.no_email_or_phone?a.opportunitySignIn.first_name&&a.opportunitySignIn.last_name&&(a.opportunitySignIn.email||a.opportunitySignIn.phone||a.opportunitySignIn.no_email_or_phone)&&(a.form_complete=!0):a.form_complete=!1}),a.signInForOpportunity=function(){var c={};c.first_name=a.opportunitySignIn.first_name,c.last_name=a.opportunitySignIn.last_name,a.opportunitySignIn.email&&(c.email=a.opportunitySignIn.email),a.opportunitySignIn.phone&&(c.phone=a.opportunitySignIn.phone),c.organization_id=a.opportunity.organization_id,b.create(c).$promise.then(function(b){a.person=b,a.opportunitySignIn.first_name="",a.opportunitySignIn.last_name="",a.opportunitySignIn.email="",a.opportunitySignIn.phone="",i.go("sign_in_form.confirmation_information",{opportunity_Id:a.opportunity.id})})},a.opportunitySignIn={},a.opportunitySignIn.first_name="",a.opportunitySignIn.last_name="",a.opportunitySignIn.email="",a.$watchGroup(["opportunitySignIn.first_name","opportunitySignIn.last_name","opportunitySignIn.email"],function(){""!==a.opportunitySignIn.first_name||""!==a.opportunitySignIn.last_name||""!==a.opportunitySignIn.email?(a.registration_found=!0,a.filtered=g("filter")(a.opportunity.signed_up_volunteers,{first_name:a.opportunitySignIn.first_name,last_name:a.opportunitySignIn.last_name,email:a.opportunitySignIn.email})):a.registration_found=!1}),a.recordHours=function(b){var d={};d.hours=a.recordedHour.hours,d.date_recorded=(new Date).toString(),a.recordedHour.opportunity_role&&(d.opportunity_role_id=a.recordedHour.opportunity_role),d.person_id=a.person.id,d.opportunity_id=c.opportunity_Id,b&&(d.organization_id=b.id),d.instance=new Date(c.instance_date),d.photo_consent=a.photo_consent,d.contact_me=a.contact_me,d.sign_in=!0,console.log(d),j.create(d),a.confirmed=!0,k(function(){i.go("sign_in_form.initial_information",{opportunity_Id:a.opportunity.id},{reload:!0})},1e3)},a.$watch("opportunity_role",function(){a.opportunity_role&&a.opportunity_role.hours_required&&(a.hours=a.opportunity_role.hours_required)})}]),angular.module("voluntrApp").controller("FABCtrl",["$scope","$modal","$rootScope","$state","$mdDialog",function(a,b,c,d,e){a.addVolunteerOpportunity=function(){e.show({controller:"AddOpportunityCtrl",templateUrl:"organizations/modals/add_opportunity.html",parent:angular.element(document.body),clickOutsideToClose:!0}).then(function(b){a.status='You said the information was "'+b+'".'},function(){a.status="You cancelled the dialog."})},a.recordHours=function(a){var c=b.open({templateUrl:"organizations/modals/record_hours_modal.html",controller:"RecordHoursCtrl",windowClass:"add-event-modal-window",size:a});c.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})},a.addOrganizationPerson=function(a){var c=b.open({templateUrl:"organizations/modals/add_person.html",controller:"AddPeopleCtrl",windowClass:"add-event-modal-window",size:a});c.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})},a.addGroup=function(a){var c=b.open({templateUrl:"organizations/modals/add_group.html",controller:"AddGroupCtrl",windowClass:"add-event-modal-window",size:a});c.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})}}]),angular.module("voluntrApp").controller("HeaderCtrl",["$scope","$rootScope","searchService","$window","$mdSidenav","$http","$stateParams","$timeout","$modal","$state","$localStorage","Organization","$mdDialog",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.search_filter=c.search,a.supportModal=function(b){var c=i.open({templateUrl:"organizations/modals/support_form.html",controller:"SupportFormCtrl",windowClass:"add-event-modal-window",size:b,resolve:{current_state:function(){return a.current_state}}});c.result.then(function(){},function(){})},a.logOut=function(){delete k.token,j.go("landing_page")},a.open=function(){e("left").open().then(function(){a.menu_open=!0})};var n=function(b){var c=b._source;console.log(c);var d={};"organization_person"==b._type&&c.person&&c.person.first_name&&c.person.first_name?(d.id=c.person_id,d.type="person",d.title=c.person.first_name+" "+c.person.last_name):"opportunity"==b._type&&(d.id=c.id,d.start_time=c.start_time,d.type="opportunity",d.title=c.name),a.results.push(d)};a.$watch("search_query",function(){a.loaded=!1,a.results=[],a.search_query&&!a.loading?(a.loading=!0,a.searching=!0,f({url:"api/v1/organizations/"+g.organization_Id+"/search",params:{query:a.search_query}}).success(function(b,c,d,e){angular.forEach(b,n),a.loading=!1,a.loaded=!0}).error(function(a,b,c,d){})):a.search_query||(a.searching=!1)}),a.close=function(){e("left").close().then(function(){a.menu_open=!1})},a.openModal=function(b){"person"===b.type?m.show({controller:"PersonDetailCtrl",templateUrl:"organizations/modals/person_detail.html",parent:angular.element(document.body),clickOutsideToClose:!0,locals:{id:b.id}}).then(function(b){a.status='You said the information was "'+b+'".'},function(){a.status="You cancelled the dialog."}):"opportunity"===b.type&&m.show({controller:"OpportunityDetailCtrl",templateUrl:"organizations/modals/opportunity_detail.html",parent:angular.element(document.body),clickOutsideToClose:!0,locals:{id:b.id,start_time:b.start_time,opportunity:f.get("api/v1/opportunities/"+b.id,{params:{instance_date:new Date(b.start_time).getTime()}})}}).then(function(b){a.status='You said the information was "'+b+'".'},function(){a.status="You cancelled the dialog."})}}]),angular.module("voluntrApp").controller("VolunteerHomeCtrl",["$scope","geolocation","Opportunity","Organization","$http","$timeout","$modal","$rootScope","leafletData",function(a,b,c,d,e,f,g,h,i){b.getLocation().then(function(b){a.coords={lat:b.coords.latitude,"long":b.coords.longitude},a.markers={m1:{lat:a.coords.lat,lng:a.coords["long"],focus:!0,message:"Your Current Location"}}}),a.getDistance=function(b){var c=new google.maps.LatLng(a.coords.lat,a.coords["long"]);!b.distance&&b.latitude&&b.longitude&&f(function(){function d(c,d){d==google.maps.DistanceMatrixStatus.OK?(console.log(c.rows[0].elements[0]),b.distance=c.rows[0].elements[0].distance.text,a.event=b):d!==google.maps.DistanceMatrixStatus.OK&&console.log(d)}var e=c,f=new google.maps.LatLng(b.latitude,b.longitude),g=new google.maps.DistanceMatrixService;g.getDistanceMatrix({origins:[e],destinations:[f],travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.IMPERIAL},d)},700)};var j=function(b){b.latitude&&b.longitude&&(a.markers[b.name]={lat:b.latitude,lng:b.longitude,message:b.name})};a.$watch("markers",function(){a.markers&&c.all().$promise.then(function(b){angular.forEach(b,j),a.opportunities=b})})}]),angular.module("voluntrApp").controller("UsersCtrl",["$scope","$modal","$rootScope",function(a,b,c){}]),angular.module("voluntrApp").controller("ConfirmUserRegistrationCtrl",["$scope","$modal","$rootScope","$stateParams","$http","$state","Profile","$timeout",function(a,b,c,d,e,f,g,h){e({method:"GET",url:"/api/v1/users/confirmation/",params:{confirmation_token:d.token}}).then(function(b){a.user=b.data,console.log(b.data),(b.data.facebook_user||b.data.password_entered&&a.user.profile.first_name&&a.user.profile.last_name)&&(a.all_information_completed=!0,h(function(){f.go("organizations.registration")},2500))},function(a){f.go("organizations.registration")}),a.userPass={},a.profile={},a.updateNewUserWithPasswordAndProfile=function(){var b={};b.user={},b.user.id=a.user.id,b.user.password=a.userPass.password,b.user.password_confirmation=a.userPass.confirm_password,e({method:"PATCH",url:"/api/v1/users/update_password",data:b}).then(function(b){var c={};c.first_name=a.profile.first_name,c.last_name=a.profile.last_name,c.user_id=a.user.id,g.create(c).$promise.then(function(){f.go("organizations.registration")})})}}]),angular.module("voluntrApp").controller("LeaderboardCtrl",["$scope","Leaderboard",function(a,b){a.data={},a.data.count=3,a.teamMostActive={more:!1,count:3},a.nonprofitHours={more:!1,count:3},a.individualHours={more:!1,count:3},a.teamAdditional={hoursPerPerson:{more:!1,count:0},participationRate:{more:!1,count:0},totalHours:{more:!1,count:0},totalEvents:{more:!1,count:0}},a.showMore=function(a){a.more?a.count=3:a.count=10,a.more=!a.more},a.additionalShowMore=function(a){a.more?a.count=0:a.count=7,a.more=!a.more},b.get().then(function(b){a.data.lb=b.data})}]),angular.module("voluntrApp").controller("PersonDetailCtrl",["$scope","Facebook","$http","$stateParams","id","People","$timeout","OrganizationPerson","uiCalendarConfig",function(a,b,c,d,e,f,g,h,i){var j=function(b){null!=b.date_recorded&&a.personStatisticGraphConfig.series[0].data.push([Date.parse(b.date_recorded),b.hours])},k=function(b){a.personOpportunitiesChart.series[0].data.push([b.opportunity.name,b.total_hours])};h.get_by_organization_and_person_id(d.organization_Id,e).$promise.then(function(b){a.organization_person_id=b.id,a.person=b.person,a.schedule=b.person.schedule_update_form_settings,a.person.notes=b.notes,f.recorded_hours(e,"recorded_hours").$promise.then(function(b){a.person.recorded_hours=b,angular.forEach(b,j)}),f.opportunities(e,"opportunities").$promise.then(function(b){a.person.opportunities=b,angular.forEach(a.person.opportunities,k)})}),a.custom_calendar={},a.custom_calendar.repeat={},a.eventSources=[{url:"api/v1/people/"+e+"/person_availability_schedule"},[]],a.uiConfig={myCalendar:{height:325,editable:!0,eventTextColor:"white",defaultView:"month",header:{left:"month agendaWeek agendaDay",center:"title",right:"today prev,next"},businessHours:{start:"7:00",end:"20:00",dow:[1,2,3,4,5]}}},a.updateWithSchedule=function(){var b={};b.id=a.person.id,b.schedule=a.schedule,f.update(b).$promise.then(function(b){a.edit_schedule=!1,i.calendars.calendar.fullCalendar("refetchEvents",a.eventSources),console.log("hello")})},a.personStatisticGraphConfig={options:{chart:{type:"spline",zoomType:"xy",renderTo:"container"}},xAxis:{type:"datetime",title:{text:"Date"}},yAxis:{allowDecimals:!1,floor:0},series:[{name:"Recorded Hours",data:[]}],title:{text:"Person Dashboard"},loading:!1,noData:"This Person Hasn't Volunteered Yet!",size:{height:"250"}},a.personOpportunitiesChart={options:{chart:{type:"pie",zoomType:"xy"}},series:[{name:"Recorded Hours",data:[]}],title:{text:"Person Opportunities Distribution"
},loading:!1,size:{height:"250"}},g(function(){window.dispatchEvent(new Event("resize")),50})}]),angular.module("voluntrApp").controller("OpportunityRoleCtrl",["$scope","$stateParams","$timeout","opportunity_role",function(a,b,c,d){a.opportunity_role=d,a.role_people=[],c(function(){window.dispatchEvent(new Event("resize")),50}),angular.forEach(a.opportunity_role.person_opportunities,function(b){console.log(b);var c={};c.name=b.person.first_name+" "+b.person.last_name,c.dates=b.instances,a.role_people.push(c)})}]),angular.module("voluntrApp").controller("OrganizationDetailCtrl",["$scope","url","Organization","$timeout","$filter","$modal","$stateParams",function(a,b,c,d,e,f,g){var h=function(b){a.opportunityGraphConfig.series[0].data.push([Date.parse(b.date),Number(b.total_recorded_hours)]),a.opportunityGraphConfig.series[1].data.push([Date.parse(b.date),Number(b.total_added_volunteers)])};c.get({organization_Id:g.organization_Id},function(b){b.users.length>0?a.contact_by_email=!0:0===b.users.length&&(a.contact_by_email=!1),console.log(a.contact_by_email)}),c.get_by_url({organization_custom_Url:b},function(b){a.organization=b,console.log(a.organization),c.daily_statistics(b.id,"daily_statistics").$promise.then(function(b){a.organization.daily_statistics=e("orderBy")(b,"date"),angular.forEach(a.organization.daily_statistics,h)}),c.public_opportunities(b.id,"public_opportunities").$promise.then(function(b){a.organization.public_opportunities=b}),c.summary_statistics(b.id,"summary_statistics").$promise.then(function(b){a.organization.statistics=b,a.organization.statistics.average_hours_recorded||(a.organization.statistics.average_hours_recorded=0)})}),a.contactOrganization=function(){var b=f.open({templateUrl:"organizations/modals/contact_organization.html",controller:"ContactOrganizationModal",windowClass:"contact-organization-modal",size:"md",resolve:{organization:function(){return a.organization}}});b.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})},a.getInvolved=function(a){var b=f.open({templateUrl:"organizations/modals/get_involved_opportunity.html",controller:"GetInvolvedOpportunityCtrl",windowClass:"get-involved-opportunity",size:"md",resolve:{opportunity:function(){return a}}});b.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})},a.opportunityGraphConfig={options:{chart:{type:"spline",zoomType:"xy"}},xAxis:{type:"datetime",title:{text:"Date"}},yAxis:{allowDecimals:!1,floor:0},series:[{name:"Total Recorded Volunteer Hours",data:[]},{name:"Total Added Volunteers",data:[]}],title:{text:"Organization Statistics"},loading:!1,size:{height:"200"}},d(function(){window.dispatchEvent(new Event("resize")),50})}]),angular.module("voluntrApp").controller("AddPeopleCtrl",["$scope","Facebook","$stateParams","$http","$state","People","$modalInstance",function(a,b,c,d,e,f,g){a.newPerson={},a.schedule={},a.addPerson=function(){var b={};b.id=a.newPerson.id,b.first_name=a.newPerson.first_name,b.last_name=a.newPerson.last_name,b.email=a.newPerson.email,b.phone=a.newPerson.phone,b.address_1=a.newPerson.address_1,b.address_2=a.newPerson.address_2,b.city=a.newPerson.city,b.state=a.newPerson.state,b.zip_code=a.newPerson.zip_code,b.notes=a.newPerson.notes,b.organization_name=a.newPerson.organization_name,b.occupation=a.newPerson.occupation,b.organization_id=c.organization_Id,b.schedule=a.schedule;f.create(b);g.dismiss("cancel")},a.matchedPerson=function(b){a.newPerson.id=b.id,a.newPerson.first_name=b.first_name,a.newPerson.last_name=b.last_name}}]),angular.module("voluntrApp").controller("RecordHoursCtrl",["$scope","$modal","$rootScope","RecordedHours","$stateParams","$http","People","$modalInstance","Organization","$filter","$state",function(a,b,c,d,e,f,g,h,i,j,k){i.get({organization_Id:e.organization_Id},function(b){a.opportunities=b.opportunities}),a.recordHours=function(){var b={};b.hours=a.recordHours.hours,b.organization_id=e.organization_Id,b.date_recorded=(new Date).toString(),b.description=a.description;var c={};c.first_name=a.first_name,c.last_name=a.last_name,c.email=a.email,a.opportunity&&(b.opportunity_id=a.opportunity.id),a.opportunity_role&&(b.opportunity_role_id=a.opportunity_role.id),a.new_volunteer?(c.organization_id=e.organization_Id,g.create(c).$promise.then(function(a){b.person_id=a.id;d.create(b)})):(c.id=a.volunteer_id,g.update(c).$promise.then(function(c){b.person_id=a.volunteer_id;d.create(b)})),"organizations.organization_home"===k.current.name&&k.go(k.current,{},{reload:!0}),h.close()},a.selectHoursPerson=function(b){a.first_name=b.first_name,a.last_name=b.last_name,a.email=b.email,a.volunteer_id=b.id},a.organization_people=i.people(e.organization_Id,"people"),a.clearPerson=function(){a.first_name="",a.last_name="",a.email="",a.volunteer_id="",a.filtered=[]},a.first_name="",a.last_name="",a.email="",a.$watchGroup(["first_name","last_name","email"],function(){""!==a.first_name||""!==a.last_name||""!==a.email?(a.results=!0,a.filtered=j("filter")(a.organization_people,{first_name:a.first_name,last_name:a.last_name})):a.results=!1,""===a.first_name||""===a.last_name||""===a.email?a.new_volunteer_validation=!0:a.new_volunteer_validation=!1})}]),angular.module("voluntrApp").controller("AddOpportunityCtrl",["$scope","$timeout","Opportunity","$stateParams","$http","$modal","OpportunityRole","$state","Upload","$mdDialog",function(a,b,c,d,e,f,g,h,i,j){a.organization={},a.organizations=[],a.calendar={},a.calendar.repeat={},a.calendar.raw_start=new Date,a.files=[],a.$watch("calendar.duration",function(){a.calendar.duration<36e5?a.duration_label="minutes":a.calendar.duration<72e5?a.duration_label="hour":a.duration_label="hours",a.calendar.end_time=a.calendar.raw_start.getTime()+a.calendar.duration}),a.removeOrganization=function(b){var c=a.organizations.indexOf(b);c>-1&&a.organizations.splice(c,1)},a.roles=[],a.role={},a.createRole=function(b){var c={};c.name=b.name,b.description&&(c.description=b.description),b.volunteers_required&&(c.volunteers_required=b.volunteers_required),b.hours_required&&(c.hours_required=b.hours_required),a.roles.push(c),a.role.name="",a.role.description="",a.role.volunteers_required="",a.role.hours_required=""},a.$watch("files",function(){a.resources=[],angular.forEach(a.files,function(b){var c={};c.name=b.name,c.file=b,a.resources.push(c)})}),a.resource_types=["For Volunteers","Internal Use"],a.newOpportunity=function(){var b={};b.calendar=a.calendar,a.newOpportunity.volunteer_goal&&(b.volunteer_goal=a.newOpportunity.volunteer_goal),b.calendar.start_time=Date.parse(a.calendar.raw_start),b.name=a.newOpportunity.opportunity_name,b.calendar.end_time=a.calendar.end_time,b.description=a.newOpportunity.description,b.address_1=a.newOpportunity.address_1,b.address_2=a.newOpportunity.address_2,b.zip_code=a.newOpportunity.zip_code,b.city=a.newOpportunity.city,b.collaborative=a.newOpportunity.collaborative,b.state=a.newOpportunity.state,b.organization_id=d.organization_Id,b.collaborative=a.newOpportunity.collaborative,b.volunteer_goal=a.newOpportunity.volunteer_goal,b.organizations=a.organizations;c.create(b).$promise.then(function(b){angular.forEach(a.roles,function(a){a.opportunity_id=b.id,g.create(a)}),j.cancel(),a.files.length>0&&angular.forEach(a.resources,function(a){i.upload({url:"/api/v1/resources",method:"POST",fields:{"resource[name]":a.name,"resource[description]":a.description,"resource[resourceable_type]":"Opportunity","resource[resourceable_id]":b.id,resource_type:a.resource_type},file:{"resource[resource]":a.file}}).then(function(a){console.log("Success "+a.config.data.file.name+"uploaded. Response: "+a.data)},function(a){console.log("Error status: "+a.status)},function(a){var b=parseInt(100*a.loaded/a.total);console.log("progress: "+b+"% "+a.config.data.file.name)})})});"organizations.opportunities_home"===h.current.name&&h.go(h.current,{},{reload:!0})}}]),angular.module("voluntrApp").controller("OpportunityDetailCtrl",["$scope","Facebook","$stateParams","$http","$state","Opportunity","id","PersonOpportunity","start_time","$modal","$cacheFactory","$timeout","OpportunityRole","opportunity","$mdDialog",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){a.openForm=function(a){$mdOpenMenu(a)},a.cancel=function(){o.cancel()},a.opportunity={},a.opportunity.instance={},a.$watch("opportunity.instance_date",function(){a.opportunity&&(d.get("/api/v1/opportunity_instances/"+a.opportunity.id+"/"+new Date(a.opportunity.instance_date)).then(function(b){a.opportunity.instance=b.data,d.get("/api/v1/opportunity_instances/"+a.opportunity.id+"/"+new Date(a.opportunity.instance_date)+"/instance_roles").then(function(b){a.opportunity.instance.instance_roles=b.data})}),d({method:"GET",url:"api/v1/opportunity_instances/"+a.opportunity.id+"/"+new Date(a.opportunity.instance_date)+"/recorded_hours"}).then(function(b){a.opportunity.recorded_hours=b.data}),d.get("/api/v1/opportunity_instances/"+a.opportunity.id+"/"+new Date(a.opportunity.instance_date)+"/instance_volunteers").then(function(b){a.opportunity.instance.instance_volunteers=b.data}),a.change_instance=!1)}),a.$watch("instance_date_sign_in",function(){if(a.instance_date_sign_in){var b=e.href("sign_in_form.initial_information",{opportunity_Id:a.opportunity.id,instance_date:a.instance_date_sign_in});window.open(b,"_blank")}}),a.$watch("change_instance",function(){if(console.log("activiated"),a.change_instance===!0&&!a.opportunity.instances){var b=new Date(a.opportunity.start_time);d({method:"GET",url:"api/v1/opportunity/"+a.opportunity.id+"/schedule",params:{start:new Date(b),end:new Date(new Date(b).setMonth(b.getMonth()+6))}}).then(function(b){a.opportunity.instances=b.data})}});var p=function(b){a.instanceStatisticGraphConfig.series[0].data.push([Date.parse(b.end_time),Number(b.instance_hours)]),a.instanceStatisticGraphConfig.series[1].data.push([Date.parse(b.end_time),Number(b.instance_people_count)])};a.opportunity=n.data,a.opportunity.instance_date=i,f.instance_statistics(a.opportunity.id,"instance_statistics").$promise.then(function(a){angular.forEach(a,p)}),a.grabData=function(b){if("roles"==b&&d.get("/api/v1/opportunity_instances/"+a.opportunity.id+"/"+new Date(a.opportunity.instance_date)+"/instance_roles").then(function(b){a.opportunity.instance.instance_roles=b.data}),("schedule"==b||"additional"==b)&&!a.opportunity.instances){var c=new Date(a.opportunity.start_time);d({method:"GET",url:"api/v1/opportunity/"+a.opportunity.id+"/schedule",params:{start:new Date(c),end:new Date(new Date(c).setMonth(c.getMonth()+6))}}).then(function(b){a.opportunity.instances=b.data})}"people"!=b||a.opportunity.volunteers||d.get("/api/v1/opportunity_instances/"+a.opportunity.id+"/"+new Date(a.opportunity.instance_date)+"/instance_volunteers").then(function(b){a.opportunity.instance.instance_volunteers=b.data}),"recorded_hours"!=b||a.opportunity.recorded_hours||d({method:"GET",url:"api/v1/opportunity_instances/"+a.opportunity.id+"/"+new Date(a.opportunity.instance_date)+"/recorded_hours"}).then(function(b){console.log(b.data[0]),a.opportunity.recorded_hours=b.data})},k.current_calendar={},k.current_calendar.schedule=a.opportunity.ical,k.current_calendar.id=a.opportunity.id,k.current_calendar.type="Opportunity",k.current_calendar.start_time=new Date(parseInt(a.opportunity.start_time)),k.current_calendar.duration=a.opportunity.duration,a.opportunity_role={},a.createOpportunityRole=function(b){var c={};c.name=b.name,c.opportunity_id=a.opportunity.id,c.volunteers_required=b.volunteers_required,c.hours_required=b.hours_required,c.description=b.description,m.create(c).$promise.then(function(b){a.opportunity.instance.instance_roles.push(b),a.opportunity_role.name="",a.opportunity_role.volunteers_required="",a.opportunity_role.hours_required="",a.opportunity_role.description=""})},a.deleteOpportunityInstance=function(){f.delete_instance(a.opportunity.id,i).$promise.then(function(a){o.cancel(),e.go(e.current,{},{reload:!0})})},a.deleteFutureInstances=function(){f.delete_future_instances(a.opportunity.id,i).$promise.then(function(a){o.cancel(),e.go(e.current,{},{reload:!0})})},a.deleteOpportunity=function(){f["delete"](a.opportunity.id).$promise.then(function(a){o.cancel(),e.go(e.current,{},{reload:!0})})},a.getArray=function(){var b=[];return angular.forEach(a.opportunity.volunteers,function(a){var c={};c.first_name=a.first_name,c.last_name=a.last_name,c.address_1=a.address_1,c.address_2=a.address_2,c.city=a.city,c.state=a.state,c.zip_code=a.zip_code,c.occupation=a.occupation,c.organization_name=a.organization_name,c.opportunity_role=a.opportunity_role,c.phone=a.phone,c.email_address=a.email,c.hours=a.opportunity_hours,b.push(c)}),b};var q=function(b){var c=b._source,d={};d.id=c.person_id,d.first_name=c.person.first_name,d.last_name=c.person.last_name,d.score=b.score,a.organization_people.push(d)};a.searching=!1,a.people_search=function(b){b&&!a.searching?(a.no_search=!1,a.organization_people=[],a.searching=!0,d({url:"api/v1/organizations/"+c.organization_Id+"/people_search",params:{query:b}}).success(function(b,c,d,e){angular.forEach(b,q),a.searching=!1}).error(function(a,b,c,d){})):b||(a.searching=!1,a.no_search=!0)},a.registerFormPreview=function(a,b){var c=j.open({templateUrl:"organizations/opportunities/registration_form.html",controller:"OpportunityRegistrationCtrl",windowClass:"add-event-modal-window",size:a});c.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})},a.signInFormPreview=function(a,b){var c=j.open({templateUrl:"organizations/opportunities/sign_in_form.html",controller:"OpportunitySignInCtrl",windowClass:"add-event-modal-window",size:a});c.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})},a.instanceStatisticGraphConfig={options:{chart:{type:"spline",zoomType:"xy",renderTo:"container"}},xAxis:{type:"datetime",title:{text:"Date"}},yAxis:{allowDecimals:!1,floor:0},series:[{name:"Recorded Hours",data:[]},{name:"People Recording",data:[]}],title:{text:"Opportunity Dashboard"},loading:!1,size:{height:"250"}},a.opportunityRolesChart={options:{chart:{type:"pie",zoomType:"xy"}},series:[{name:"Recorded Hours",data:[]}],title:{text:"Hours Recorded For Roles"},loading:!1,size:{height:"250"}},l(function(){window.dispatchEvent(new Event("resize")),50})}]),angular.module("voluntrApp").controller("AddOpportunityPersonCtrl",["$scope","Facebook","$stateParams","$http","$state","opportunity","PersonOpportunity","$modal","start_time","$modalInstance",function(a,b,c,d,e,f,g,h,i,j){a.opportunity=f,a.instance=i._start._i,d({url:"api/v1/opportunities/"+a.opportunity.id+"/instance",method:"GET",params:{instance_date:a.instance}}).then(function(b){console.log(b),a.instance_volunteers=b.data.instance_volunteers}),a.addOpportunityPerson=function(){var b={};b.person_id=a.person.id,b.instances=a.instance,a.opportunity_role&&(b.opportunity_role_id=a.opportunity_role.id),b.opportunity_id=f.id,console.log(b),g.create(b),j.close()}}]),angular.module("voluntrApp").controller("EmailLogInCtrl",["$scope","$modalInstance","$http","Auth","$state","$localStorage","Facebook",function(a,b,c,d,e,f,g){a.facebook_log_in=function(){g.login(function(b){a.oauth_key=b.authResponse.accessToken},{scope:"manage_pages,email"})},a.$watch("oauth_key",function(){a.oauth_key&&g.api("/me",function(d){a.user=d;var g={};g.fb_id=a.user.id,g.token=a.oauth_key,g.first_name=a.user.first_name,g.last_name=a.user.last_name,g.email=a.user.email,c({url:"/api/v1/users/login/facebook_login",method:"GET",params:g}).then(function(a){f.token=a.data.token}),e.go("organizations.user_organizations"),b.close()})}),a.close=function(){b.close()},a.userSignIn=function(){var c={};c.email=a.login.email,c.password=a.login.password,d.login(c).then(function(c){c.token?(console.log(c.token),delete f.token,f.token=c.token,e.go("organizations.user_organizations"),b.close()):c.token||(a.error=c.error)})}}]),angular.module("voluntrApp").controller("OpportunitySignInConfirmationCtrl",["$scope","$modal","$modalInstance","$stateParams","person","opportunity","RecordedHours","$timeout","Idle","Keepalive","Group",function(a,b,c,d,e,f,g,h,i,j,k){a.organization={},a.opportunity=f,a.photo_consent=!0,a.contact_me=!0,a.timeDuration=function(){var b={};b.hours=a.hours,b.date_recorded=(new Date).toString(),void 0!==a.opportunity_role&&(b.opportunity_role_id=a.opportunity_role.id),void 0!==a.group&&(b.group_id=a.group.id),b.person_id=e.id,b.opportunity_id=d.opportunity_Id,a.organization.id&&(b.organization_id=a.organization.id),b.photo_consent=a.photo_consent,b.contact_me=a.photo_consent,b.sign_in=!0,g.create(b),a.confirmed=!0,h(function(){c.dismiss("cancel")},1e3)},a.states="AL AK AZ AR CA CO CT DE FL GA HI ID IL IN IA KS KY LA ME MD MA MI MN MS MO MT NE NV NH NJ NM NY NC ND OH OK OR PA RI SC SD TN TX UT VT VA WA WV WI WY".split(" ").map(function(a){return{abbrev:a}}),a.$watch("opportunity_role",function(){a.opportunity_role&&a.opportunity_role.hours_required&&(a.hours=a.opportunity_role.hours_required)})}]),angular.module("voluntrApp").controller("EditScheduleCtrl",["$scope","$cacheFactory","Opportunity","$modalInstance",function(a,b,c,d){}]),angular.module("voluntrApp").controller("AddResourceCtrl",["$scope","$modal","$modalInstance",function(a,b,c){}]),angular.module("voluntrApp").controller("PreviewEmailTemplateCtrl",["$scope","$modal","$modalInstance",function(a,b,c){}]),angular.module("voluntrApp").controller("SupportFormCtrl",["$scope","$rootScope","searchService","$window","$http","$stateParams","$timeout","$modal","current_state","$modalInstance",function(a,b,c,d,e,f,g,h,i,j){a.current_state=i,a.submitFeedback=function(){a.sending=!0;var b={};b.email=a.email,b.description=a.description,b.current_state=i,e.post("api/v1/administration/feedback",{data:b}).then(function(a){j.close()})}}]),angular.module("voluntrApp").controller("TOSCtrl",["$scope","Organization","$modalInstance","organization_id","$sce",function(a,b,c,d,e){b.get({organization_Id:d},function(b){a.organization=b,a.pdfUrl=a.organization.terms_of_service_file.terms_of_service_file.url})}]),angular.module("voluntrApp").controller("AuxiliaryModalWindowCtrl",["$scope","$modal","type","object","$modalInstance","Opportunity","People","object_id","uiCalendarConfig",function(a,b,c,d,e,f,g,h,i){a.calendar={},a.calendar.repeat={},a.calendar.repeat.monthly_repeat_type={},a.type=c;var j=function(b){"MO"===b?a.calendar.repeat.monday_repeat=!0:"TU"===b?a.calendar.repeat.tuesday_repeat=!0:"WE"===b?a.calendar.repeat.wednesday_repeat=!0:"TH"===b?a.calendar.repeat.thursday_repeat=!0:"FR"===b?a.calendar.repeat.friday_repeat=!0:"SA"===b?a.calendar.repeat.saturday_repeat=!0:"SU"===b&&(a.calendar.repeat.sunday_repeat=!0)};("recurring-schedule"==a.type||"create-opportunity"==a.type)&&(a.calendar=d,a.calendar.repeating_event=!0),"edit-schedule"===a.type&&(d.duration&&(a.calendar.duration=36e5*d.duration),a.editing_calendar=!0,a.calendar.raw_start=new Date(d.start_time),a.calendar.schedule=d.ical,a.calendar.id=d.id,a.calendar.schedule&&(console.log(a.calendar.schedule),a.calendar.repeating_event=!0,a.calendar.repeat={},"undefined"!=typeof a.calendar.schedule.COUNT&&(a.calendar.repeat.number_of_occurrences=a.calendar.schedule.COUNT),a.calendar.repeat.repeat_count=parseInt(a.calendar.schedule.INTERVAL),"DAILY"===a.calendar.schedule.FREQ?(a.calendar.repeat.repeat_daily=!0,a.calendar.repeat.repeat_type="repeat_daily"):"WEEKLY"===a.calendar.schedule.FREQ?(a.calendar.repeat.repeat_weekly=!0,a.calendar.repeat.repeat_type="repeat_weekly"):"MONTHLY"===a.calendar.schedule.FREQ?(a.calendar.repeat.repeat_monthly=!0,a.calendar.repeat.repeat_type="repeat_monthly"):"ANNUALLY"===a.calendar.schedule.FREQ&&(a.calendar.repeat.repeat_annually=!0,a.calendar.repeat.repeat_type="repeat_annually"),"string"==typeof a.calendar.schedule.BYDAY&&(a.calendar.schedule.BYDAY=a.calendar.schedule.BYDAY.split(",")),angular.forEach(a.calendar.schedule.BYDAY,j))),a.updateSchedule=function(){var b={};b.calendar=a.calendar,a.calendar.repeat.repeat_until?b.calendar.repeat.repeat_until=a.calendar.repeat.repeat_until:a.calendar.repeat.number_of_occurrences&&(b.calendar.repeat.repeat_number_of_occurrences=a.calendar.repeat.number_of_occurrences),b.id=a.calendar.id,f.update_schedule(b);var c=document.getElementsByClassName("modal-dialog");c[0].classList.remove("auxiliary-open"),e.close()},a.addSchedule=function(){var b={};b.name=a.calendar.name,b.calendar=a.calendar,b.id=h,g.add_schedule(b).$promise.then(function(b){i.calendars.calendar.fullCalendar("refetchEvents",a.eventSources);var c=document.getElementsByClassName("modal-dialog");c[0].classList.remove("auxiliary-open"),e.close()})},a.closeWindow=function(){var b=document.getElementsByClassName("modal-dialog");b[0].classList.remove("auxiliary-open"),e.close(),("recurring-schedule"===a.type||"create-opportunity"===a.type)&&(a.calendar.repeat={},a.calendar.repeating_event=!1)},a.saveSchedule=function(){e.close()}}]),angular.module("voluntrApp").controller("ContactOrganizationModal",["$scope","organization","$stateParams","$http","$modalInstance",function(a,b,c,d,e){a.organization=b,a.sendEmail=function(){d.post("/api/v1/organizations/"+c.organization_Id+"/contact_organization",{contacting_organization_id:b.id,message:a.email_content}).success(function(b,c,d,f){a.confirmation_message=!0,e.close()}).error(function(a,b,c,d){})}}]),angular.module("voluntrApp").controller("GetInvolvedOpportunityCtrl",["$scope","$modal","$modalInstance","opportunity",function(a,b,c,d){a.opportunity=d}]),angular.module("voluntrApp").controller("GenerateReportCtrl",["$scope","$modal","$rootScope","$http","$stateParams","rm_id","$window","type","$modalInstance",function(a,b,c,d,e,f,g,h,i){a.date={startDate:null,endDate:null},a.report_loaded=!1,a.exportReport=function(){a.report_loaded=!0;var b=window.open("about:blank","_blank");"opportunity"===h?d.get("api/v1/reports/opportunity/"+f,{params:{start_date:a.date.startDate,end_date:a.date.endDate},headers:{"Content-Type":"application/pdf"}}).success(function(a){b.location.href=a.url}):"person"==h?d.get("api/v1/reports/person/"+f,{params:{start_date:a.date.startDate,end_date:a.date.endDate,organization_id:e.organization_Id},headers:{"Content-Type":"application/pdf"}}).success(function(a){b.location.href=a.resource.resource.url}):"organization"==h&&d.get("api/v1/reports/organization/"+f,{params:{start_date:a.date.startDate,end_date:a.date.endDate,organization_id:e.organization_Id}}).success(function(a){b.location.href=a.url}),i.close()}}]),angular.module("voluntrApp").controller("AddFacebookOrganization",["$scope","$stateParams","$modalInstance","$state","organization","Organization","user","$localStorage","token",function(a,b,c,d,e,f,g,h,i){console.log(g),a.addOrganization=function(){a.organization=e;var j={};j.fb_id=e.id,j.first_name=g.first_name,j.u_fb_id=g.id,j.email=g.email,j.last_name=g.last_name,j.name=e.name,j.organization_type_name=a.organization_type_name,j.description=e.description,j.oauth_key=i;f.create(j).$promise.then(function(a){h.token=a.token,c.close(),d.go("organizations.tutorial.1",{organization_Id:a.organization.id}),b.organization_Id=a.id})}}]),angular.module("voluntrApp").controller("ImportPeopleModalCtrl",["$scope","$modalInstance","$http","$state","$localStorage","import_information","$stateParams",function(a,b,c,d,e,f,g){a.query={limit:5,order:"first_name",page:1},a.selected=[],a.query={filter:"",order:"first_name",limit:5,page:1},a.onOrderChange=function(){},a.onPaginate=function(a,b){},a.people=f.people,a.name_column=f.name_column,a.address_column=f.address_column,a["import"]=function(){c.post("/api/v1/people/import",f).then(function(b){a.imported=!0,a.success_message=b.data.success_message}),b.close(),d.go("organizations.people_home",{organization_Id:g.organization_Id})},a.redoMappings=function(){b.close(),d.go(d.current,{},{reload:!0})},a.filter={options:{debounce:500}}}]),angular.module("voluntrApp").controller("CreateOrganizationModal",["$scope","Organization","$stateParams","$mdDialog","$state","$localStorage",function(a,b,c,d,e,f){a.organization={},a.createOrganization=function(){var c={};c.name=a.organization.name,c.organization_type_name=a.organization.organization_type_name,c.address_1=a.organization.address,c.address_2=a.organization.address2,c.city=a.organization.city,c.state=a.organization.state,c.zip_code=a.organization.postalCode,b.create_with_email(c).$promise.then(function(a){f.token=a.token,e.go("organizations.tutorial.1",{organization_Id:a.organization.id})}),d.cancel()},a.states="AL AK AZ AR CA CO CT DE FL GA HI ID IL IN IA KS KY LA ME MD MA MI MN MS MO MT NE NV NH NJ NM NY NC ND OH OK OR PA RI SC SD TN TX UT VT VA WA WV WI WY".split(" ").map(function(a){return{abbrev:a}})}]),angular.module("voluntrApp").directive("scroll",["$window",function(a){return function(b,c,d){angular.element(a).bind("scroll",function(){console.log("Keep scrolling scrolling scrolling"),b.sticky=!0,b.$apply()})}}]),angular.module("voluntrApp").directive("compareTo",function(){return{require:"ngModel",scope:{comparedValue:"=compareTo"},link:function(a,b,c,d){d.$validators.compareTo=function(b){return b===a.comparedValue},a.$watch("comparedValue",function(){d.$validate()})}}}),angular.module("voluntrApp").directive("fileread",[function(){return{scope:{fileread:"="},link:function(a,b,c){b.bind("change",function(b){function c(a){for(var b="",c=0,d=10240;c<a.byteLength/d;++c)b+=String.fromCharCode.apply(null,new Uint8Array(a.slice(c*d,c*d+d)));return b+=String.fromCharCode.apply(null,new Uint8Array(a.slice(c*d)))}var d=new FileReader,e=!1;d.onload=function(b){var d,f=b.target.result,g=c(f);try{d=XLSX.read(btoa(g),{type:"base64"})}catch(h){console.log(h),e=!0}a.$apply(function(){a.fileread=d})},d.onloadend=function(){e?(a.$emit("fileError"),a.$apply()):a.$emit("fileChange")},d.readAsArrayBuffer(b.target.files[0])})}}}]),angular.module("voluntrApp").directive("addResource",function(){return{transclude:!0,templateUrl:"organizations/directives/add_resource.html",scope:{object:"=",resourcesList:"=",type:"@"},restrict:"E",controller:["$scope","Upload",function(a,b){if(a.resources=[],a.$watch("files",function(){a.files&&a.files.length>0&&(angular.forEach(a.files,function(b){var c={};c.name=b.name,c.file=b,a.resources.push(c)}),a.files=[])}),a.deleteResource=function(b){var c=a.resources.indexOf(b);c>-1&&a.resources.splice(c,1)},"opportunity"===a.type)var c="Opportunity";a.resource_types=["For Volunteers","Internal Use"],a.uploadFiles=function(){a.resources.length>0&&angular.forEach(a.resources,function(d){b.upload({url:"/api/v1/resources",method:"POST",fields:{"resource[name]":d.name,"resource[description]":d.description,"resource[resourceable_type]":c,"resource[resourceable_id]":a.object.id,resource_type:d.resource_type},file:{"resource[resource]":d.file}}).then(function(b){a.resourcesList.push(d)})})}}]}}),angular.module("voluntrApp").directive("opportunityInstance",function(){return{transclude:!0,templateUrl:"organizations/directives/opportunity_instance.html",scope:{instancesList:"=",opportunity:"=",currentInstance:"="},restrict:"E",controller:["$scope","$mdDialog","$modal","$http",function(a,b,c,d){a.switchDates=function(b){a.currentInstance=b}}]}}),angular.module("voluntrApp").directive("addPersonOpportunity",function(){return{transclude:!0,templateUrl:"organizations/directives/add_person_opportunity.html",scope:{type:"@",selectedObject:"=",opportunity:"=",instance:"="},restrict:"E",controller:["$scope","$mdDialog","PersonOpportunity",function(a,b,c){a.openForm=function(a){$mdOpenMenu(a)},a.person={},a.person_opportunity={},a.addPersonOpportunity=function(){var b={};b.instances=[],"instance"!==a.type?b.instances.push(new Date(a.opportunity.instance_date)):"instance"===a.type&&b.instances.push(new Date(a.selectedObject.instance_date)),"role"===a.type?b.opportunity_role_id=a.selectedObject.id:"role"!==a.type&&(b.opportunity_role_id=a.person_opportunity.opportunity_role),b.first_name=a.person.first_name,b.last_name=a.person.last_name,b.opportunity_id=a.opportunity.id,a.person.email?b.email=a.person.email:a.person.phone&&(b.phone=a.person.phone),c.create(b),a.person={},a.person_opportunity={}}}]}}),angular.module("voluntrApp").directive("logInModal",["$modal",function(a){function b(b,c,d){c.bind("click",function(){var b=a.open({templateUrl:"organizations/modals/log_in.html",controller:"EmailLogInCtrl",windowClass:"log-in-modal",size:"sm"});b.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})})}return{link:b}}]),angular.module("voluntrApp").directive("organizationModal",["$modal",function(a){function b(b,c,d){c.bind("click",function(){var b=a.open({templateUrl:"organizations/modals/public_organization_details.html",controller:"OrganizationDetailCtrl",windowClass:"organization-detail-window",size:"lg",resolve:{url:function(){return d.url}}});b.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})})}return{link:b}}]),angular.module("voluntrApp").directive("personModal",["$mdDialog",function(a){function b(b,c,d){c.bind("click",function(){a.show({controller:"PersonDetailCtrl",templateUrl:"organizations/modals/person_detail.html",parent:angular.element(document.body),clickOutsideToClose:!0,locals:{id:d.id}}).then(function(a){$scope.status='You said the information was "'+a+'".'},function(){$scope.status="You cancelled the dialog."})})}return{link:b}}]),angular.module("voluntrApp").directive("opportunityModal",["$modal",function(a){function b(b,c,d){c.bind("click",function(){var b=a.open({templateUrl:"organizations/modals/opportunity_detail.html",controller:"OpportunityDetailCtrl",windowClass:"add-event-modal-window",size:d.size,resolve:{id:function(){return d.id},start_time:function(){return d.start_time?start_time:d.start_time?void 0:0}}});b.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})})}return{link:b}}]),angular.module("voluntrApp").directive("editObjectDirective",function(){return{transclude:!0,templateUrl:"organizations/directives/edit_object_directive.html",scope:{text:"@",size:"@",modelType:"@",attributeName:"@",modelId:"@",placeholder:"@"},restrict:"E",controller:["$scope","Opportunity","Organization","People","OrganizationPerson",function(a,b,c,d,e){"title_text"===a.size?a.title_text=!0:"subtitle_text"===a.size?a.subtitle_text=!0:"paragraph_text"===a.size?a.paragraph_text=!0:"link"===a.size&&(a.link=!0),a.editText=function(){a.editing=!0},a.updateText=function(){if(a.editing=!1,a.text=a.text,"opportunity"===a.modelType){var f={};f.id=a.modelId,f[a.attributeName]=a.text,b.update(f)}if("organization"===a.modelType){var f={};f.id=a.modelId,f[a.attributeName]=a.text,c.update(f)}if("person"===a.modelType){var f={};f.id=a.modelId,f[a.attributeName]=a.text,d.update(f)}if("organization_person"===a.modelType){var f={};f.id=a.modelId,f[a.attributeName]=a.text,e.update(f)}}}]}}),angular.module("voluntrApp").directive("objectSchedule",function(){return{transclude:!0,templateUrl:"organizations/directives/object_schedule.html",scope:{objectType:"@",object:"="},restrict:"E",controller:["$scope","$modal",function(a,b){console.log(a.object),a.eventSources=[{url:"api/v1/"+a.objectType+"/"+a.object.id+"/schedule"}],a.editSchedule=function(a){var c=b.open({templateUrl:"organizations/modals/edit-schedule.html",controller:"EditScheduleCtrl",windowClass:"edit-schedule-window",size:a});c.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})},a.uiConfig={myCalendar:{height:500,editable:!0,timezone:"local",header:{left:"month agendaWeek agendaDay",center:"title",right:"today prev,next"},businessHours:{start:"7:00",end:"20:00",dow:[1,2,3,4,5]}}},a.uiConfig.myCalendar.eventClick=function(c,d,e){if("opportunity"==a.objectType){var f=b.open({templateUrl:"organizations/modals/add_person_opportunity.html",controller:"AddOpportunityPersonCtrl",windowClass:"add-opportunity-person",size:"sm",resolve:{opportunity:function(){return a.object;
},start_time:function(){return c}}});f.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})}}}]}}),angular.module("voluntrApp").directive("scheduleForm",function(){return{transclude:!0,templateUrl:"organizations/directives/schedule-form.html",scope:{recurringLabelText:"@",startDateText:"@",calendar:"=",type:"@"},restrict:"E",controller:["$scope","$http","Schedule",function(a,b,c){a.calendar.repeat.monthly_repeat_type={},a.$watch("calendar",function(b,d){if(a.calendar.start_time=Date.parse(a.calendar.raw_start),a.calendar.end_time=a.calendar.raw_start.getTime()+a.calendar.duration,b.duration===d.duration&&b.end_time===d.end_time)var e=!0;if("repeat_daily"===a.calendar.repeat.repeat_type&&(a.repeat_type_text="days"),"repeat_weekly"===a.calendar.repeat.repeat_type&&(a.repeat_type_text="weeks"),"repeat_monthly"===a.calendar.repeat.repeat_type&&(a.repeat_type_text="months"),"repeat_annually"===a.calendar.repeat.repeat_type&&(a.repeat_type_text="years"),a.calendar.start_time&&e){var f={};f.calendar=a.calendar,c.schedule_string(f.calendar).$promise.then(function(b){a.schedule_string=b.schedule})}},!0),a.current_screen="beginning-information",a.calendar.raw_start&&a.calendar.duration&&"create-opportunity"===a.type&&(a.calendar.repeating_event=!0,a.current_screen="repeat_type"),a.$watch("calendar.duration",function(){a.calendar.start_time&&(a.calendar.duration<36e5?a.duration_label="minutes":a.calendar.duration<72e5?a.duration_label="hour":a.duration_label="hours",a.calendar.end_time=a.calendar.raw_start.getTime()+a.calendar.duration)}),a.previousScreen=function(b){"repeat_type"===b&&(a.calendar.repeat={},a.calendar.repeating_event=!1,a.current_screen="beginning-information"),"repeat_frequency"===b&&(a.current_screen="repeat_type"),("repeat_daily"===b||"repeat_weekly"===b||"repeat_monthly"===b||"repeat_annually"===b)&&(a.current_screen="repeat_frequency"),"opportunity_end"===b&&("repeat_daily"==a.calendar.repeat.repeat_type||"repeat_annually"==a.calendar.repeat.repeat_type?a.current_screen="repeat_frequency":"repeat_daily"!==a.calendar.repeat.repeat_type&&"repeat_annually"!==a.calendar.repeat.repeat_type&&(a.current_screen=a.calendar.repeat.repeat_type))},a.nextScreen=function(b,c){"beginning-information"===b&&(a.calendar.repeating_event=!0,a.current_screen="repeat_type"),"repeat_type"===b&&(a.calendar.repeat.repeat_type=c,a.current_screen="repeat_frequency"),"repeat_frequency"===b&&(a.calendar.repeat.repeat_count=c,"repeat_annually"==a.calendar.repeat.repeat_type?a.current_screen="opportunity_end":"repeat_annually"!==a.calendar.repeat.repeat_type&&(a.current_screen=a.calendar.repeat.repeat_type)),("repeat_daily"===b||"repeat_weekly"===b||"repeat_monthly"===b||"repeat_annually"===b)&&(a.current_screen="opportunity_end")}}]}}),angular.module("voluntrApp").directive("editAddress",function(){return{transclude:!0,templateUrl:"organizations/directives/edit_address.html",scope:{address1:"@",address2:"@",zipCode:"@",state:"@",city:"@",modelId:"@",addressType:"@"},restrict:"E",controller:["$scope","Opportunity","People","Organization",function(a,b,c,d){a.editing=!1,a.editAddress=function(){a.editing=!0},a.saveAddress=function(){var e={};e.id=a.modelId,e.address_1=a.address1,e.address_2=a.address2,e.city=a.city,e.zip_code=a.zipCode,e.state=a.state,"opportunity"===a.addressType?b.update(e):"person"==a.addressType?c.update(e):"organization"==a.addressType&&d.update(e),a.editing=!1}}]}}),angular.module("voluntrApp").directive("addResources",function(){return{transclude:!0,templateUrl:"organizations/directives/add_resources.html",scope:{resourceId:"@"},restrict:"E",controller:["$scope","Opportunity","$modal",function(a,b,c){a.openAddResourceModal=function(a){var b=c.open({templateUrl:"organizations/modals/add_resource.html",controller:"AddResourceCtrl",windowClass:"add-event-modal-window",size:a});b.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})}}]}}),angular.module("voluntrApp").directive("emailTemplatePreview",function(){return{transclude:!0,templateUrl:"organizations/directives/organization_email_template.html",scope:{resourceId:"@"},restrict:"E",controller:["$scope","Opportunity","$modal",function(a,b,c){a.openEmailPreview=function(a,b){var d=c.open({templateUrl:"organizations/modals/preview_organization_template_email.html",controller:"PreviewEmailTemplateCtrl",windowClass:"add-event-modal-window",size:a});d.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})}}]}}),angular.module("voluntrApp").directive("recordedHour",function(){return{transclude:!0,templateUrl:"organizations/directives/recorded_hour.html",scope:{recordedHour:"=",recordedHours:"=",type:"@"},restrict:"E",controller:["$scope","RecordedHours",function(a,b){a.editing=!1,a.saveRecordedHours=function(c){var d={};d.id=c.id,d.hours=c.hours,c.opportunity_role&&(d.opportunity_role_id=c.opportunity_role.id),b.update(d),a.editing=!1},a.deleteRecordedHour=function(c){b["delete"](c.id);var d=a.recordedHours.indexOf(c);d>-1&&a.recordedHours.splice(d,1)}}]}}),angular.module("voluntrApp").directive("opportunityRole",function(){return{transclude:!0,templateUrl:"organizations/directives/opportunity_role.html",scope:{rolesList:"=",opportunity:"=",type:"@"},restrict:"E",controller:["$scope","OpportunityRole","$mdDialog","$modal",function(a,b,c,d){a.updateOpportunityRole=function(c){if("new"!==a.type){var d={};d.id=c.id,d.name=c.name,d.description=c.description,d.volunteers_required=c.volunteers_required,d.hours_required=c.hours_required;var c=b.update(d);a.editing=!1}},a.deleteOpportunityRole=function(c){var d=a.rolesList.indexOf(c);d>-1&&a.rolesList.splice(d,1),"new"!==a.type&&(b["delete"](c.id),a.opportunity_role.name="",a.opportunity_role.description="")},a.viewVolunteers=function(a){var b=d.open({templateUrl:"organizations/modals/opportunity_role.html",controller:"OpportunityRoleCtrl",windowClass:"opportunity-role-modal",size:"sm",resolve:{opportunity_role:function(){return a}}});b.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})}}]}}),angular.module("voluntrApp").directive("editMailingServiceList",function(){return{transclude:!0,templateUrl:"organizations/directives/mailing_service_list.html",scope:{cabbage:"="},restrict:"E",controller:["$scope","OrganizationMailingService",function(a,b){a.organization_mailing_service=a.cabbage,a.editing=!1,a.update=function(c){a.editing=!1;var d={};d.id=c.organization_mailing_service_id,d.default_list_id=c.id,b.update(d)}}]}}),angular.module("voluntrApp").directive("reportLink",["$modal",function(a){function b(b,c,d){c.bind("click",function(){var b=a.open({templateUrl:"organizations/modals/generate_report.html",controller:"GenerateReportCtrl",windowClass:"generate-report-window",size:"sm",resolve:{rm_id:function(){return d.id},type:function(){return d.type}}});b.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})})}return{link:b}}]),angular.module("voluntrApp").directive("personSchedule",function(){return{transclude:!0,templateUrl:"organizations/directives/person_schedule.html",scope:{personId:"@",schedule:"="},restrict:"E",controller:["$scope","Opportunity","$modal",function(a,b,c){a.schedule||(a.schedule={}),a.schedule.morning||(a.schedule.morning={}),a.schedule.afternoon||(a.schedule.afternoon={}),a.schedule.night||(a.schedule.night={}),(1==a.schedule.morning.monday||1==a.schedule.afternoon.monday||1==a.schedule.night.monday)&&(a.Mon=!0),(1==a.schedule.morning.tuesday||1==a.schedule.afternoon.tuesday||1==a.schedule.night.tuesday)&&(a.Tue=!0),(1==a.schedule.morning.wednesday||1==a.schedule.afternoon.wednesday||1==a.schedule.night.wednesday)&&(a.Wed=!0),(1==a.schedule.morning.thursday||1==a.schedule.afternoon.thursday||1==a.schedule.night.thursday)&&(a.Thu=!0),(1==a.schedule.morning.friday||1==a.schedule.afternoon.friday||1==a.schedule.night.friday)&&(a.Fri=!0),(1==a.schedule.morning.saturday||1==a.schedule.afternoon.saturday||1==a.schedule.night.saturday)&&(a.Sat=!0),(1==a.schedule.morning.sunday||1==a.schedule.afternoon.sunday||1==a.schedule.night.sunday)&&(a.Sun=!0)}]}}),angular.module("voluntrApp").directive("findPerson",function(){return{transclude:!0,templateUrl:"organizations/directives/find_person.html",scope:{person:"="},restrict:"E",controller:["$scope","$http","$stateParams",function(a,b,c){var d=function(b){var c=b._source,d={};d.id=c.person_id,d.first_name=c.person.first_name,d.last_name=c.person.last_name,d.score=b.score,-1==a.people.indexOf(d)&&(console.log("push"),a.people.push(d))};a.searching=!1,a.people_search=function(e){a.people=[],console.log(a.people),e&&!a.searching?(a.searching=!0,a.no_search=!1,b({url:"api/v1/organizations/"+c.organization_Id+"/people_search",params:{query:e}}).success(function(b,c,e,f){angular.forEach(b,d),a.searching=!1}).error(function(a,b,c,d){})):e||(a.searching=!1,a.no_search=!0)},a.selectPerson=function(b){a.person=b,a.volunteer_search=a.person.first_name+" "+a.person.last_name,a.no_search=!0}}]}}),angular.module("voluntrApp").directive("termsOfService",["$modal",function(a){function b(b,c,d){c.bind("click",function(){console.log(d);var b=a.open({templateUrl:"organizations/modals/terms_of_service.html",controller:"TOSCtrl",windowClass:"terms-of-service-modal",size:"md",resolve:{organization_id:function(){return d.organizationId}}});b.result.then(function(){},function(){console.log("Modal dismissed at: "+new Date)})})}return{link:b}}]),angular.module("voluntrApp").directive("auxiliaryModalWindow",["$modal",function(a){return{scope:{type:"@",id:"@",object:"="},link:function(b,c,d){c.bind("click",function(){var c=a.open({templateUrl:"organizations/modals/auxiliary_modal_window.html",controller:"AuxiliaryModalWindowCtrl",windowClass:"auxiliary-modal-window",size:d.size,resolve:{type:function(){return b.type},object:function(){return b.object},object_id:function(){return b.id}}});c.result.then(function(){},function(){e[0].classList.remove("auxiliary-open")});var e=document.getElementsByClassName("modal-dialog");e[0].classList.add("auxiliary-open")})}}}]),angular.module("voluntrApp").directive("organizationSearch",function(){return{transclude:!0,templateUrl:"organizations/directives/organization_search.html",scope:{organization:"=",selectedOrganizations:"=",type:"@"},restrict:"E",controller:["$scope","$http",function(a,b){var c=function(b){console.log(b);var c=b._source,d={};d.id=c.id,d.name=c.name,d.city=c.city,d.state=c.state,a.organizations.push(d)};a.addOrganization=function(b){"multiple"===a.type&&(a.selectedOrganizations.push(b),a.search_query=""),"single"===a.type&&(a.organization=b,a.search_query="")},a.$watch("search_query",function(){a.loaded=!1,a.organizations=[],a.search_query&&!a.loading?(a.loading=!0,a.searching=!0,b({url:"api/v1/search/organizations_search",params:{query:a.search_query}}).success(function(b,d,e,f){angular.forEach(b,c),a.loading=!1,a.loaded=!0}).error(function(a,b,c,d){})):a.search_query||(a.searching=!1)})}]}}),angular.module("voluntrApp").directive("resource",function(){return{transclude:!0,templateUrl:"organizations/directives/resource.html",scope:{resourcesList:"=",object:"=",type:"@"},restrict:"E",controller:["$scope","$mdDialog","Resource",function(a,b,c){a.deleteResource=function(b){var d=a.resourcesList.indexOf(b);d>-1&&a.resourcesList.splice(d,1),c["delete"](b.id)},a.resource_types=["For Volunteers","Internal Use"],a.updateResource=function(a){var b={};b.id=a.id,b.name=a.name,b.description=a.description,b.type_name=a.type_name,c.update(b)}}]}}),angular.module("voluntrApp").directive("voluForm",function(){return{transclude:!0,template:'<form class="form-container"><h2 class="form-title">{{title}}</h2><p class="form-description">{{description}}</p><div class="form-alert">{{alert}}</div><div ng-transclude></div></form>',restrict:"E",scope:{alert:"=",title:"@",description:"@"}}}),angular.module("voluntrApp").directive("voluFormSection",function(){return{transclude:!0,template:'<div layout="row" class="form-section"><div flex="100"><h3 class="form-section-title">{{title}}</h3><p class="form-section-text">{{description}}</p><div ng-transclude></div></div>',restrict:"E",scope:{title:"@",description:"@"}}}),angular.module("voluntrApp").directive("voluFormGroup",function(){return{transclude:!0,template:'<div class="form-group"><p class="form-group-description">{{direction}}</p><div ng-transclude></div></div>',restrict:"E",scope:{direction:"@"}}}),angular.module("voluntrApp").directive("horizontalBarChart",function(){function a(a,b,c){var d={top:5,right:5,bottom:5,left:5},e=375-d.left-d.right,f=130-d.top-d.bottom,g=40,h=d3.select(b[0]).append("svg").attr("width",e+d.left+d.right).attr("height",f+d.top+d.bottom).append("g").attr("transform","translate("+d.left+","+d.top+")"),i=d3.scale.ordinal().range(["#333333","#444444","#555555"]);a.$watch("data",function(a){if(a){a=[a[0],a[1],a[2]];var b=d3.scale.linear().domain([0,d3.max(a,function(a){return a.value})]).range([0,e-80]),c=h.selectAll(".bar").data(a).enter().append("g").attr("transform",function(a,b){return"translate(0,"+b*g+")"});c.append("rect").attr("width",function(a){return b(a.value)}).attr("height",g-1).style("fill",function(a,b){return i(b)}),c.append("text").attr("x",5).attr("y",g/2).attr("dy",".35em").attr("fill","#FFFFFF").text(function(a){return a.name}),c.append("text").attr("x",function(a){return b(a.value)+5}).attr("y",g/2).attr("dy",".35em").attr("fill","#FFFFFF").text(function(a){return a.value+"hrs/person"})}})}return{restrict:"E",scope:{data:"="},link:a}}),angular.module("voluntrApp").directive("pieChart",function(){function a(a,b,c){var d={top:5,right:5,bottom:5,left:5},e=100-d.left-d.right,f=100-d.top-d.bottom,g=d3.select(b[0]).append("svg").attr("width",e+d.left+d.right).attr("height",f+d.top+d.bottom).append("g").attr("transform","translate(50,50)"),h=d3.scale.ordinal().range(["#333333","#555555"]),i=Math.min(e,f)/2,j=d3.svg.arc().innerRadius(0).outerRadius(i),k=d3.layout.pie().sort(null).value(function(a){return a.value});a.$watch("data",function(a){if(a){a=[a,{value:100-a.value}];var b=g.selectAll(".arc").data(k(a)).enter().append("g").attr("class","arc");b.append("path").attr("d",j).style("fill",function(a,b){return h(b)}),g.append("text").attr("x",0).attr("y",0).style("text-anchor","center").style("fill","#FFFFFF").text(a[0].value+"%")}})}return{restrict:"E",scope:{data:"="},link:a}}),angular.module("voluntrApp").directive("stackedBarChart",function(){function a(a,b,c){var d={top:5,right:5,bottom:5,left:5},e=375-d.left-d.right,f=550-d.top-d.bottom,g=d3.select(b[0]).append("svg").attr("width",e+d.left+d.right).attr("height",f+d.top+d.bottom).append("g").attr("transform","translate("+d.left+","+d.top+")"),h=d3.scale.linear().range([0,f]),i=d3.scale.ordinal().range(["#333333","#444444","#555555"]);a.$watch("data",function(a){if(a){a=[a[0],a[1],a[2]],h.domain([0,d3.sum(a,function(a){return a.value})]);var b=0;a.forEach(function(a){a.y0=b,b+=h(a.value)});var c=(g.selectAll(".bar").data(a).enter().append("rect").attr("class","bar").attr("height",function(a){return h(a.value)}).attr("width",e-10).attr("x",5).attr("y",function(a){return a.y0}).style("fill",function(a,b){return i(b)}),g.selectAll(".text").data(a));c.enter().append("text").attr("class","text").attr("x",e/2).attr("y",function(a){return a.y0+20}).attr("text-anchor","middle").attr("fill","#FFFFFF").text(function(a){return a.name}),c.enter().append("text").attr("class","text").attr("x",e/2).attr("y",function(a){return a.y0+50}).attr("text-anchor","middle").attr("fill","#FFFFFF").text(function(a){return a.value+" hours"})}})}return{restrict:"E",scope:{data:"="},link:a}}),angular.module("voluntrApp").directive("podiumChart",function(){function a(a,b,c){var d={top:5,right:5,bottom:5,left:0},e=375-d.left-d.right,f=110-d.top-d.bottom,g=e/3,h=d3.select(b[0]).append("svg").attr("width",e+d.left+d.right).attr("height",f+d.top+d.bottom).append("g").attr("transform","translate("+d.left+","+d.top+")");a.$watch("data",function(a){if(a){a=[a[0],a[1],a[2]];var b=d3.scale.ordinal().range(["#444444","#333333","#555555"]);a=[a[1],a[0],a[2]],console.log(a);var c=h.selectAll(".bar").data(a).enter().append("g").attr("transform",function(a,b){return"translate("+b*g+",20)"});c.append("rect").attr("width",g-1).attr("height",function(a,b){return 0===b?60:1===b?80:2===b?40:void 0}).attr("y",function(a,b){return 0===b?40:1===b?20:2===b?60:void 0}).attr("fill",function(a,c){return b(c)}),c.append("text").attr("x",g/2).attr("y",80).attr("fill","#FFFFFF").attr("text-anchor","middle").text(function(a){return a.value}),c.append("text").attr("x",g/2).attr("y",function(a,b){return 0===b?30:1===b?10:2===b?50:void 0}).attr("fill","#FFFFFF").attr("text-anchor","middle").text(function(a){return a.name})}})}return{restrict:"E",scope:{data:"="},link:a}}),angular.module("voluntrApp").filter("trusted",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b)}}]),angular.module("voluntrApp").filter("startFrom",function(){return function(a,b){return a?(b=+b,a.slice(b)):[]}});